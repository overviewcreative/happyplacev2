System.register(["./chunks/unified-archive-legacy-BujbrpqF.min.js","./chunks/universal-loop-legacy-BB4QGSeb.min.js"],function(t,e){"use strict";return{setters:[null,null],execute:function(){if("undefined"==typeof HPHMap){class t{getMapStyle(t){const e={professional:"mapbox://styles/mapbox/light-v11",luxury:"mapbox://styles/mapbox/dark-v11",streets:"mapbox://styles/mapbox/streets-v12",satellite:"mapbox://styles/mapbox/satellite-streets-v12",minimal:"mapbox://styles/mapbox/light-v11",navigation:"mapbox://styles/mapbox/navigation-day-v1"};return e[t]||e.professional}constructor(t,e={}){this.container="string"==typeof t?document.getElementById(t):t,this.map=null,this.markers=[],this.popups=[],this.options={style:this.getMapStyle(e.styleTheme||"professional"),zoom:15,center:[-75.1398,38.7816],pitch:0,bearing:0,attributionControl:!0,navigationControl:!0,fullscreenControl:!1,geolocateControl:!1,scaleControl:!1,styleTheme:"professional",markerTheme:"happyPlace",...e},this.init()}init(){if(this.container)if(window.hph_mapbox_config)if(window.hph_mapbox_config.access_token||!1===window.hph_mapbox_config.has_token)if(!1!==window.hph_mapbox_config.has_token)if("undefined"!=typeof mapboxgl)try{mapboxgl.accessToken=window.hph_mapbox_config.access_token,this.container&&(this.container.innerHTML=""),this.map=new mapboxgl.Map({container:this.container,style:this.options.style,center:this.options.center,zoom:this.options.zoom,pitch:this.options.pitch,bearing:this.options.bearing,attributionControl:this.options.attributionControl}),this.addControls(),this.map.on("load",()=>{this.onMapLoad()}),this.map.on("resize",()=>{this.map.resize()}),this.container.dispatchEvent(new CustomEvent("hph-map-initialized",{detail:{map:this.map,instance:this}}))}catch(t){this.showError("Failed to load map")}else this.showError("Mapbox GL JS library not available");else this.showConfigurationMessage();else this.showError("Map configuration not available");else this.showError("Map configuration not available")}addControls(){this.options.navigationControl&&this.map.addControl(new mapboxgl.NavigationControl({showCompass:!1,visualizePitch:!1}),"top-right"),this.options.fullscreenControl&&this.map.addControl(new mapboxgl.FullscreenControl,"top-right"),this.options.geolocateControl&&this.map.addControl(new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!1}),"top-right"),this.options.scaleControl&&this.map.addControl(new mapboxgl.ScaleControl({maxWidth:100,unit:"imperial"}),"bottom-left")}onMapLoad(){}addListingMarker(t,e={}){if(!t.latitude||!t.longitude)return null;const i={showPopup:!0,popupOffset:25,className:"hph-listing-marker",...e},s=new mapboxgl.Marker({color:"#0ea5e9"}).setLngLat([parseFloat(t.longitude),parseFloat(t.latitude)]).addTo(this.map);if(i.showPopup){const e=this.createListingPopup(t,i);s.setPopup(e)}return this.markers.push({type:"listing",id:t.id,marker:s,data:t}),s}addListingMarkers(t,e={}){const i={enableClustering:!0,clusterRadius:50,clusterMaxZoom:14,showPopup:!0,fitBounds:!0,...e};if(i.enableClustering&&t.length>1)this.addClusteredMarkers(t,i);else{const e=[];t.forEach(t=>{const s=this.addListingMarker(t,i);s&&e.push(s)}),i.fitBounds&&e.length>1&&this.fitToMarkers(e)}return i.showZipBoundary&&i.zipCode&&this.addZipCodeBoundary(t,i.zipCode),this.markers}getHPHColors(){const t=getComputedStyle(document.documentElement);return{primary:t.getPropertyValue("--hph-primary").trim()||"#1e40af",secondary:t.getPropertyValue("--hph-secondary").trim()||"#059669",accent:t.getPropertyValue("--hph-accent").trim()||"#dc2626",warning:t.getPropertyValue("--hph-warning").trim()||"#f59e0b",muted:t.getPropertyValue("--hph-muted").trim()||"#6b7280"}}addClusteredMarkers(t,e={}){this.clearMapMarkers();const i=this.getHPHColors(),s=t.filter(t=>{const e=t.latitude&&t.longitude&&!isNaN(parseFloat(t.latitude))&&!isNaN(parseFloat(t.longitude));return!e&&t.id,e});if(0===s.length)return;const n={type:"FeatureCollection",features:s.map(t=>({type:"Feature",geometry:{type:"Point",coordinates:[parseFloat(t.longitude),parseFloat(t.latitude)]},properties:{id:t.id,title:t.title||"",price:t.price||0,address:t.street_address||"",status:t.status||"active",featured_image:t.featured_image||"",bedrooms:t.bedrooms||0,bathrooms:t.bathrooms||0,square_feet:t.square_feet||0,permalink:t.permalink||"#"}}))};try{const t={type:"geojson",data:n,cluster:!0,clusterMaxZoom:e.clusterMaxZoom||14,clusterRadius:e.clusterRadius||50};this.map.addSource("listings",t)}catch(a){return}try{const t={id:"clusters",type:"circle",source:"listings",filter:["has","point_count"],paint:{"circle-color":["step",["get","point_count"],i.primary||"#2563eb",5,i.secondary||"#06b6d4",10,i.accent||"#dc2626"],"circle-radius":["step",["get","point_count"],25,5,35,10,45],"circle-stroke-width":3,"circle-stroke-color":"#ffffff","circle-opacity":.9}};this.map.addLayer(t)}catch(a){return}this.map.addLayer({id:"cluster-count",type:"symbol",source:"listings",filter:["has","point_count"],layout:{"text-field":"{point_count}","text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":16,"text-anchor":"center"},paint:{"text-color":"#ffffff","text-halo-color":"rgba(0, 0, 0, 0.3)","text-halo-width":1}});try{const t={id:"unclustered-point",type:"circle",source:"listings",filter:["!",["has","point_count"]],paint:{"circle-color":["match",["get","status"],"active",i.secondary||"#10b981","pending",i.warning||"#f59e0b","sold",i.muted||"#6b7280",i.primary||"#2563eb"],"circle-radius":12,"circle-stroke-width":3,"circle-stroke-color":"#ffffff","circle-opacity":.9}};this.map.addLayer(t)}catch(a){return}this.addClusterEventHandlers(e),e.fitBounds&&n.features.length>0&&this.fitToGeoJSON(n)}highlightListingMarker(t){if(!this.map||!t)return;this.unhighlightAllMarkers(),this.map.getSource("highlight-marker")||(this.map.addSource("highlight-marker",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.map.addLayer({id:"highlight-marker-circle",type:"circle",source:"highlight-marker",paint:{"circle-radius":20,"circle-color":"rgba(255, 255, 255, 0.8)","circle-stroke-width":4,"circle-stroke-color":"#ff6b35"}}));const e=this.map.getSource("listings");if(e&&e.t){const i=e.t.features.find(e=>e.properties.id==t);i&&(this.map.getSource("highlight-marker").setData({type:"FeatureCollection",features:[i]}),this.map.easeTo({center:i.geometry.coordinates,zoom:Math.max(this.map.getZoom(),16),duration:1e3}))}}unhighlightAllMarkers(){if(this.map)try{this.map.getSource("highlight-marker")&&this.map.getSource("highlight-marker").setData({type:"FeatureCollection",features:[]})}catch(t){}}showListingPopup(t){if(!this.map||!t)return;const e=this.map.getSource("listings");if(e&&e.t){const i=e.t.features.find(e=>e.properties.id==t);i&&this.createListingPopupFromFeature(i.properties,i.geometry.coordinates).addTo(this.map)}}addClusterEventHandlers(t={}){this.map.on("click","clusters",t=>{const e=this.map.queryRenderedFeatures(t.point,{layers:["clusters"]}),i=e[0].properties.cluster_id;this.map.getSource("listings").getClusterExpansionZoom(i,(t,i)=>{t||this.map.easeTo({center:e[0].geometry.coordinates,zoom:i})})}),this.map.on("click","unclustered-point",e=>{const i=e.features[0].properties;t.showPopup&&this.createListingPopupFromFeature(i,e.lngLat).addTo(this.map),this.map.fire("listing-click",{listing:i,coordinates:e.lngLat}),document.dispatchEvent(new CustomEvent("hph-map-listing-click",{detail:{listingId:i.id,listing:i,coordinates:e.lngLat}}))}),this.map.on("mouseenter","clusters",()=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseleave","clusters",()=>{this.map.getCanvas().style.cursor=""}),this.map.on("mouseenter","unclustered-point",()=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseleave","unclustered-point",()=>{this.map.getCanvas().style.cursor=""})}createListingPopupFromFeature(t,e){const i=new mapboxgl.Popup({offset:25,closeButton:!0,closeOnClick:!1,className:"hph-listing-popup hph-map-card-popup"}),s=this.getHPHColors(),n=t.price?this.formatPrice(t.price):"",a=t.featured_image||"",o=t.title||t.address||"Property",r=t.address||t.street_address||"",h={active:{text:"Active",color:s.secondary},pending:{text:"Pending",color:s.warning},sold:{text:"Sold",color:s.muted},new:{text:"New",color:s.primary}},l=t.status?h[t.status.toLowerCase()]:null,p=`\n            <div style="width: 320px; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 10px 25px rgba(0,0,0,0.15);">\n                ${a&&!a.includes("placeholder")?`\n                    <div style="position: relative; height: 200px; overflow: hidden;">\n                        <img src="${a}" alt="${o}" style="width: 100%; height: 100%; object-fit: cover;" loading="lazy">\n                        ${l?`\n                            <div style="position: absolute; top: 12px; left: 12px;">\n                                <span style="background: ${l.color}; color: white; padding: 4px 8px; border-radius: 6px; font-size: 12px; font-weight: 600;">${l.text}</span>\n                            </div>\n                        `:""}\n                    </div>\n                `:""}\n                \n                <div style="padding: 16px;">\n                    <h3 style="margin: 0 0 8px 0; font-size: 18px; font-weight: 600; color: #1f2937;">${o}</h3>\n                    \n                    ${r?`\n                        <p style="margin: 0 0 12px 0; font-size: 14px; color: #6b7280;">${r}</p>\n                    `:""}\n                    \n                    <div style="font-size: 24px; font-weight: 700; color: ${s.primary}; margin-bottom: 12px;">${n}</div>\n                    \n                    ${t.bedrooms||t.bathrooms||t.square_feet?`\n                        <div style="display: flex; gap: 16px; font-size: 14px; color: #6b7280; margin-bottom: 16px;">\n                            ${t.bedrooms?`<div style="display: flex; align-items: center; gap: 4px;"><i class="fas fa-bed"></i><span>${t.bedrooms} bed</span></div>`:""}\n                            ${t.bathrooms?`<div style="display: flex; align-items: center; gap: 4px;"><i class="fas fa-bath"></i><span>${t.bathrooms} bath</span></div>`:""}\n                            ${t.square_feet?`<div style="display: flex; align-items: center; gap: 4px;"><i class="fas fa-ruler-combined"></i><span>${Number(t.square_feet).toLocaleString()} sqft</span></div>`:""}\n                        </div>\n                    `:""}\n                    \n                    ${t.permalink?`\n                        <a href="${t.permalink}" style="display: inline-block; background: ${s.primary}; color: white; padding: 8px 16px; border-radius: 6px; text-decoration: none; font-size: 14px; font-weight: 600;">\n                            View Details →\n                        </a>\n                    `:""}\n                </div>\n            </div>\n        `;return i.setLngLat(e).setHTML(p),i}fitToGeoJSON(t){if(!t.features||0===t.features.length)return;const e=new mapboxgl.LngLatBounds;t.features.forEach(t=>{e.extend(t.geometry.coordinates)}),this.map.fitBounds(e,{padding:50,maxZoom:15})}clearMapMarkers(){if(this.map){this.markers&&this.markers.length>0&&(this.markers.forEach(t=>{t.marker&&t.marker.remove&&t.marker.remove()}),this.markers=[]);try{this.map.getLayer("clusters")&&this.map.removeLayer("clusters"),this.map.getLayer("cluster-count")&&this.map.removeLayer("cluster-count"),this.map.getLayer("unclustered-point")&&this.map.removeLayer("unclustered-point"),this.map.getLayer("unclustered-point-label")&&this.map.removeLayer("unclustered-point-label"),this.map.getSource("listings")&&this.map.removeSource("listings")}catch(t){}}}getMarkerTheme(t=null){const e={happyPlace:{active:"#10b981",pending:"#f59e0b",sold:"#ef4444",default:"var(--hph-primary)"},luxury:{active:"#8fbc8f",pending:"#cd853f",sold:"#8b0000",default:"#d4af37"},minimal:{active:"#059669",pending:"#d97706",sold:"#dc2626",default:"#000000"}};return e[t||this.options.markerTheme||"happyPlace"]||e.happyPlace}createListingMarkerElement(t,e){return null}createListingPopup(t,e){const i=new mapboxgl.Popup({offset:e.popupOffset||25,closeButton:!0,closeOnClick:!1,className:"hph-listing-popup hph-map-card-popup"}),s=this.getHPHColors(),n=t.price?this.formatPrice(t.price):"",a=t.featured_image||"",o=t.street_address||"",r=this.formatLocation(t),h={active:{text:"Active",color:s.secondary},pending:{text:"Pending",color:s.warning},sold:{text:"Sold",color:s.muted},new:{text:"New",color:s.primary}},l=t.status?h[t.status.toLowerCase()]:null,p=`\n            <div class="hph-card hph-card--elevated hph-bg-white hph-overflow-hidden hph-max-w-80">\n                ${a&&!a.includes("placeholder")?`\n                    <div class="hph-relative hph-h-48 hph-overflow-hidden">\n                        <img src="${a}" \n                             alt="${t.title||o||"Property"}" \n                             class="hph-w-full hph-h-full hph-object-cover hph-transition-transform hph-duration-300 hover:hph-scale-105"\n                             loading="lazy"\n                             onerror="this.parentElement.style.display='none'">\n                        \n                        ${l?`\n                            <div class="hph-absolute hph-top-3 hph-left-3">\n                                <span class="hph-inline-flex hph-items-center hph-px-2 hph-py-1 hph-rounded-md hph-text-xs hph-font-semibold hph-shadow-sm"\n                                      style="background-color: ${l.color}; color: white;">\n                                    ${l.text}\n                                </span>\n                            </div>\n                        `:""}\n                        \n                        <button class="hph-absolute hph-top-3 hph-right-3 hph-w-9 hph-h-9 hph-bg-white hph-rounded-full hph-flex hph-items-center hph-justify-center hph-text-gray-500 hover:hph-text-red-500 hph-transition-colors hph-shadow-sm" \n                                data-listing-id="${t.id||""}" \n                                onclick="event.stopPropagation();">\n                            <i class="fas fa-heart hph-text-sm"></i>\n                        </button>\n                    </div>\n                `:""}\n                \n                <div class="hph-p-4">\n                    \x3c!-- Price --\x3e\n                    ${n?`\n                        <div class="hph-font-bold hph-text-xl hph-mb-2" style="color: ${s.primary};">\n                            ${n}\n                        </div>\n                    `:""}\n                    \n                    \x3c!-- Street Address --\x3e\n                    <h3 class="hph-text-gray-900 hph-font-semibold hph-text-base hph-mb-1 hph-line-clamp-1">\n                        ${o||t.title||"Property Address"}\n                    </h3>\n                    \n                    \x3c!-- Location (if different from street address) --\x3e\n                    ${r&&r!==o?`\n                        <p class="hph-text-sm hph-text-gray-500 hph-mb-3">${r}</p>\n                    `:""}\n                    \n                    \x3c!-- Property Details --\x3e\n                    ${t.bedrooms||t.bathrooms||t.square_feet?`\n                        <div class="hph-flex hph-items-center hph-gap-4 hph-text-sm hph-text-gray-600 hph-mb-4">\n                            ${t.bedrooms?`\n                                <div class="hph-flex hph-items-center hph-gap-1">\n                                    <i class="fas fa-bed hph-text-gray-500"></i>\n                                    <span>${t.bedrooms} bed${1!=t.bedrooms?"s":""}</span>\n                                </div>\n                            `:""}\n                            ${t.bathrooms?`\n                                <div class="hph-flex hph-items-center hph-gap-1">\n                                    <i class="fas fa-bath hph-text-gray-500"></i>\n                                    <span>${t.bathrooms} bath${1!=t.bathrooms?"s":""}</span>\n                                </div>\n                            `:""}\n                            ${t.square_feet?`\n                                <div class="hph-flex hph-items-center hph-gap-1">\n                                    <i class="fas fa-ruler-combined hph-text-gray-500"></i>\n                                    <span>${this.formatNumber(t.square_feet)} sq ft</span>\n                                </div>\n                            `:""}\n                        </div>\n                    `:'<div class="hph-mb-4"></div>'}\n                    \n                    \x3c!-- Action Button --\x3e\n                    <a href="${t.permalink||"#"}" \n                       class="hph-btn hph-w-full hph-text-center hph-py-3 hph-font-semibold hph-transition-all hph-duration-200 hover:hph-shadow-lg"\n                       style="background-color: ${s.primary}; color: white; display: inline-block; padding: 8px 16px; border-radius: 6px; text-decoration: none;"\n                       onclick="event.stopPropagation();">\n                        View Details\n                        <i class="fas fa-arrow-right hph-ml-2"></i>\n                    </a>\n                </div>\n            </div>\n        `;return i.setHTML(p),i}addPOIMarker(t,e={}){if(!t.latitude||!t.longitude)return null;const i=new mapboxgl.Marker({color:"#f59e0b"}).setLngLat([parseFloat(t.longitude),parseFloat(t.latitude)]).addTo(this.map);if(!1!==e.showPopup){const s=this.createPOIPopup(t,e);i.setPopup(s)}return this.markers.push({type:"poi",id:t.id||t.name,marker:i,data:t}),i}createPOIMarkerElement(t,e){return null}createPOIPopup(t,e){const i=new mapboxgl.Popup({offset:15,closeButton:!0,className:"hph-poi-popup"}),s=`\n            <div class="hph-popup-content">\n                <div class="hph-popup-details">\n                    <h4 class="hph-popup-title">${t.name||t.title}</h4>\n                    ${t.type?`<div class="hph-popup-type">${t.type}</div>`:""}\n                    ${t.address?`<div class="hph-popup-address">\n                        <i class="fas fa-map-marker-alt"></i>\n                        ${t.address}\n                    </div>`:""}\n                    ${t.description?`<div class="hph-popup-description">\n                        ${t.description}\n                    </div>`:""}\n                </div>\n            </div>\n        `;return i.setHTML(s),i}getPOIIcon(t){const e={school:"fas fa-graduation-cap",hospital:"fas fa-hospital",restaurant:"fas fa-utensils",shopping:"fas fa-shopping-bag",park:"fas fa-tree",gas_station:"fas fa-gas-pump",bank:"fas fa-university",gym:"fas fa-dumbbell",pharmacy:"fas fa-pills",default:"fas fa-map-pin"};return e[t]||e.default}fitToMarkers(t=null){const e=t||this.markers.map(t=>t.marker);if(0===e.length)return;if(1===e.length){const t=e[0].getLngLat();return void this.map.flyTo({center:t,zoom:this.options.zoom})}const i=new mapboxgl.LngLatBounds;e.forEach(t=>{i.extend(t.getLngLat())}),this.map.fitBounds(i,{padding:50,maxZoom:16})}clearMarkers(t=null){this.markers.forEach((e,i)=>{t&&e.type!==t||(e.marker.remove(),this.markers.splice(i,1))})}getMarker(t,e=null){return this.markers.find(i=>i.id===t&&(!e||i.type===e))}showConfigurationMessage(){this.container&&(this.container.innerHTML='\n            <div class="hph-map-error">\n                <div class="hph-map-error-icon">\n                    <i class="fas fa-map-marked-alt"></i>\n                </div>\n                <div class="hph-map-error-message">\n                    <h4>Map Configuration Required</h4>\n                    <p>To enable map view, please configure your Mapbox access token in the Happy Place plugin settings.</p>\n                    <div style="margin-top: 1rem;">\n                        <small style="color: #666; font-style: italic;">\n                            Visit the Happy Place admin panel to add your Mapbox API key.\n                        </small>\n                    </div>\n                </div>\n            </div>\n        ')}showError(t){this.container&&(this.container.innerHTML=`\n            <div class="hph-map-error">\n                <div class="hph-map-error-icon">\n                    <i class="fas fa-exclamation-triangle"></i>\n                </div>\n                <div class="hph-map-error-message">\n                    <h4>Map Unavailable</h4>\n                    <p>${t}</p>\n                </div>\n            </div>\n        `)}formatPrice(t){const e=parseFloat(t);return isNaN(e)?t:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}formatNumber(t){return new Intl.NumberFormat("en-US").format(t)}formatAddress(t){const e=[];return(t.street_address||t.street_number&&t.street_name)&&e.push(t.street_address||`${t.street_number} ${t.street_name} ${t.street_type||""}`.trim()),t.city&&e.push(t.city),t.state&&e.push(t.state),t.zip_code&&e.push(t.zip_code),e.join(", ")}formatLocation(t){const e=[];return t.city&&e.push(t.city),t.state&&e.push(t.state),e.join(", ")}setStyle(t,e=null){if(!this.map)return;const i=this.getMapStyle(t);this.map.setStyle(i),this.options.styleTheme=t,e&&(this.options.markerTheme=e,this.updateMarkerThemes())}updateMarkerThemes(){const t=this.getMarkerTheme();this.markers.forEach(e=>{if("listing"===e.type){const i=e.marker.getElement(),s=e.data,n=t[s.status?.toLowerCase()]||t.default;i.style.setProperty("--marker-color",n),i.style.setProperty("--marker-border-color",n),i.className=i.className.replace(/hph-marker-theme--\w+/,""),i.classList.add(`hph-marker-theme--${this.options.markerTheme}`);const a=i.querySelector(".hph-marker-icon");a&&(a.style.backgroundColor=n)}})}addStyleControl(){const t={onAdd:()=>{const t=document.createElement("div");return t.className="mapboxgl-ctrl mapboxgl-ctrl-group hph-style-control",[{name:"Professional",value:"professional",icon:"fas fa-building"},{name:"Luxury",value:"luxury",icon:"fas fa-gem"},{name:"Satellite",value:"satellite",icon:"fas fa-satellite"},{name:"Streets",value:"streets",icon:"fas fa-road"}].forEach(e=>{const i=document.createElement("button");i.type="button",i.innerHTML=`<i class="${e.icon}"></i>`,i.title=e.name,i.addEventListener("click",()=>{this.setStyle(e.value)}),t.appendChild(i)}),t},onRemove:()=>{}};this.map.addControl(t,"top-left")}toggle3DBuildings(t=!0){this.map&&this.map.on("style.load",()=>{t?this.map.addLayer({id:"add-3d-buildings",source:"composite","source-layer":"building",filter:["==","extrude","true"],type:"fill-extrusion",minzoom:15,paint:{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":.6}}):this.map.getLayer("add-3d-buildings")&&this.map.removeLayer("add-3d-buildings")})}addZipCodeBoundary(t,e){if(!this.map)return;const i=t.filter(t=>t.zip_code&&t.zip_code===e);if(!(i.length<2))try{const t=i.map(t=>[parseFloat(t.longitude),parseFloat(t.latitude)]),s=this.calculateBounds(t),n=this.createBoundingPolygon(s);this.map.getSource("zip-boundary")&&(this.map.removeLayer("zip-boundary-fill"),this.map.removeLayer("zip-boundary-line"),this.map.removeSource("zip-boundary")),this.map.addSource("zip-boundary",{type:"geojson",data:{type:"Feature",geometry:{type:"Polygon",coordinates:[n]},properties:{zipCode:e}}}),this.map.addLayer({id:"zip-boundary-fill",type:"fill",source:"zip-boundary",paint:{"fill-color":"#0ea5e9","fill-opacity":.1}}),this.map.addLayer({id:"zip-boundary-line",type:"line",source:"zip-boundary",paint:{"line-color":"#0ea5e9","line-width":2,"line-dasharray":[2,2]}})}catch(s){}}calculateBounds(t){let e=1/0,i=-1/0,s=1/0,n=-1/0;return t.forEach(([t,a])=>{e=Math.min(e,t),i=Math.max(i,t),s=Math.min(s,a),n=Math.max(n,a)}),{minLng:e,maxLng:i,minLat:s,maxLat:n}}createBoundingPolygon(t){const e=.005,i=t.minLng-e,s=t.maxLng+e,n=t.minLat-e,a=t.maxLat+e;return[[i,n],[s,n],[s,a],[i,a],[i,n]]}removeZipCodeBoundary(){if(this.map)try{this.map.getSource("zip-boundary")&&(this.map.removeLayer("zip-boundary-fill"),this.map.removeLayer("zip-boundary-line"),this.map.removeSource("zip-boundary"))}catch(t){}}clearMarkers(){if(this.map){this.markers&&this.markers.length>0&&(this.markers.forEach(t=>{t.marker&&t.marker.remove&&t.marker.remove()}),this.markers=[]);try{this.map.getLayer("clusters")&&this.map.removeLayer("clusters"),this.map.getLayer("cluster-count")&&this.map.removeLayer("cluster-count"),this.map.getLayer("unclustered-point")&&this.map.removeLayer("unclustered-point"),this.map.getLayer("unclustered-point-label")&&this.map.removeLayer("unclustered-point-label"),this.map.getSource("listings")&&this.map.removeSource("listings")}catch(t){}}}destroy(){this.map&&(this.clearMapMarkers(),this.removeZipCodeBoundary(),this.map.remove(),this.map=null)}}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-hph-map]").forEach(e=>{if(!e.hasAttribute("data-archive-map"))try{const i={};e.dataset.mapCenter&&(i.center=JSON.parse(e.dataset.mapCenter)),e.dataset.mapZoom&&(i.zoom=parseInt(e.dataset.mapZoom)),e.dataset.mapStyle&&(i.style=e.dataset.mapStyle);const s=new t(e,i);if(e.dataset.mapListings){const t=JSON.parse(e.dataset.mapListings),i={fitBounds:t.length>1};e.dataset.showZipBoundary&&e.dataset.zipCode&&(i.showZipBoundary=!0,i.zipCode=e.dataset.zipCode),s.addListingMarkers(t,i)}e.dataset.mapPois&&JSON.parse(e.dataset.mapPois).forEach(t=>s.addPOIMarker(t)),e.hphMap=s}catch(i){}})}),void 0!==e&&e.exports?e.exports=t:window.HPHMap=t}window.hphDebug}}});
