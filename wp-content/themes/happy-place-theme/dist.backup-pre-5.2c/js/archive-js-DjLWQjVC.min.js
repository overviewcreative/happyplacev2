import"./chunks/unified-archive-Cy72yypt.min.js";import"./chunks/universal-loop-Dtt4_HFB.min.js";function u(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}if(typeof HPHMap>"u"){class l{getMapStyle(e){const t={professional:"mapbox://styles/mapbox/light-v11",luxury:"mapbox://styles/mapbox/dark-v11",streets:"mapbox://styles/mapbox/streets-v12",satellite:"mapbox://styles/mapbox/satellite-streets-v12",minimal:"mapbox://styles/mapbox/light-v11",navigation:"mapbox://styles/mapbox/navigation-day-v1"};return t[e]||t.professional}constructor(e,t={}){this.container=typeof e=="string"?document.getElementById(e):e,this.map=null,this.markers=[],this.popups=[],this.options={style:this.getMapStyle(t.styleTheme||"professional"),zoom:15,center:[-75.1398,38.7816],pitch:0,bearing:0,attributionControl:!0,navigationControl:!0,fullscreenControl:!1,geolocateControl:!1,scaleControl:!1,styleTheme:"professional",markerTheme:"happyPlace",...t},this.init()}init(){if(this.container){if(!window.hph_mapbox_config){this.showError("Map configuration not available");return}if(!window.hph_mapbox_config.access_token&&window.hph_mapbox_config.has_token!==!1){this.showError("Map configuration not available");return}if(window.hph_mapbox_config.has_token===!1){this.showConfigurationMessage();return}if(typeof mapboxgl>"u"){this.showError("Mapbox GL JS library not available");return}try{mapboxgl.accessToken=window.hph_mapbox_config.access_token,this.container&&(this.container.innerHTML=""),this.map=new mapboxgl.Map({container:this.container,style:this.options.style,center:this.options.center,zoom:this.options.zoom,pitch:this.options.pitch,bearing:this.options.bearing,attributionControl:this.options.attributionControl}),this.addControls(),this.map.on("load",()=>{this.onMapLoad()}),this.map.on("resize",()=>{this.map.resize()}),this.container.dispatchEvent(new CustomEvent("hph-map-initialized",{detail:{map:this.map,instance:this}}))}catch(e){this.showError("Failed to load map")}}}addControls(){this.options.navigationControl&&this.map.addControl(new mapboxgl.NavigationControl({showCompass:!1,visualizePitch:!1}),"top-right"),this.options.fullscreenControl&&this.map.addControl(new mapboxgl.FullscreenControl,"top-right"),this.options.geolocateControl&&this.map.addControl(new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!1}),"top-right"),this.options.scaleControl&&this.map.addControl(new mapboxgl.ScaleControl({maxWidth:100,unit:"imperial"}),"bottom-left")}onMapLoad(){}addListingMarker(e,t={}){if(!e.latitude||!e.longitude)return null;const a={showPopup:!0,popupOffset:25,className:"hph-listing-marker",...t},r=new mapboxgl.Marker({color:"#0ea5e9"}).setLngLat([parseFloat(e.longitude),parseFloat(e.latitude)]).addTo(this.map);if(a.showPopup){const s=this.createListingPopup(e,a);r.setPopup(s)}return this.markers.push({type:"listing",id:e.id,marker:r,data:e}),r}addListingMarkers(e,t={}){const a={enableClustering:!0,clusterRadius:50,clusterMaxZoom:14,showPopup:!0,fitBounds:!0,...t};if(a.enableClustering&&e.length>1)this.addClusteredMarkers(e,a);else{const r=[];e.forEach(s=>{const o=this.addListingMarker(s,a);o&&r.push(o)}),a.fitBounds&&r.length>1&&this.fitToMarkers(r)}return a.showZipBoundary&&a.zipCode&&this.addZipCodeBoundary(e,a.zipCode),this.markers}getHPHColors(){const e=getComputedStyle(document.documentElement);return{primary:e.getPropertyValue("--hph-primary").trim()||"#1e40af",secondary:e.getPropertyValue("--hph-secondary").trim()||"#059669",accent:e.getPropertyValue("--hph-accent").trim()||"#dc2626",warning:e.getPropertyValue("--hph-warning").trim()||"#f59e0b",muted:e.getPropertyValue("--hph-muted").trim()||"#6b7280"}}addClusteredMarkers(e,t={}){console.log("HPHMap: Starting addClusteredMarkers with",e.length,"listings"),console.log("HPHMap: Options:",t),this.clearMapMarkers();const a=this.getHPHColors();console.log("HPHMap: Colors:",a);const r=e.filter(o=>{const i=o.latitude&&o.longitude&&!isNaN(parseFloat(o.latitude))&&!isNaN(parseFloat(o.longitude));return!i&&o.id&&console.warn("HPHMap: Listing",o.id,"missing valid coordinates:",{lat:o.latitude,lng:o.longitude}),i});if(console.log("HPHMap: Valid listings with coordinates:",r.length),r.length===0){console.warn("HPHMap: No listings with valid coordinates found");return}const s={type:"FeatureCollection",features:r.map(o=>({type:"Feature",geometry:{type:"Point",coordinates:[parseFloat(o.longitude),parseFloat(o.latitude)]},properties:{id:o.id,title:o.title||"",price:o.price||0,address:o.street_address||"",status:o.status||"active",featured_image:o.featured_image||"",bedrooms:o.bedrooms||0,bathrooms:o.bathrooms||0,square_feet:o.square_feet||0,permalink:o.permalink||"#"}}))};console.log("HPHMap: GeoJSON prepared with",s.features.length,"features"),console.log("HPHMap: Sample feature:",s.features[0]);try{const o={type:"geojson",data:s,cluster:!0,clusterMaxZoom:t.clusterMaxZoom||14,clusterRadius:t.clusterRadius||50};console.log("HPHMap: Adding source with config:",o),this.map.addSource("listings",o),console.log("HPHMap: Source added successfully")}catch(o){console.error("HPHMap: Error adding source:",o);return}try{const o={id:"clusters",type:"circle",source:"listings",filter:["has","point_count"],paint:{"circle-color":["step",["get","point_count"],a.primary||"#2563eb",5,a.secondary||"#06b6d4",10,a.accent||"#dc2626"],"circle-radius":["step",["get","point_count"],25,5,35,10,45],"circle-stroke-width":3,"circle-stroke-color":"#ffffff","circle-opacity":.9}};console.log("HPHMap: Adding cluster layer with config:",o),this.map.addLayer(o),console.log("HPHMap: Cluster layer added successfully")}catch(o){console.error("HPHMap: Error adding cluster layer:",o);return}this.map.addLayer({id:"cluster-count",type:"symbol",source:"listings",filter:["has","point_count"],layout:{"text-field":"{point_count}","text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":16,"text-anchor":"center"},paint:{"text-color":"#ffffff","text-halo-color":"rgba(0, 0, 0, 0.3)","text-halo-width":1}});try{const o={id:"unclustered-point",type:"circle",source:"listings",filter:["!",["has","point_count"]],paint:{"circle-color":["match",["get","status"],"active",a.secondary||"#10b981","pending",a.warning||"#f59e0b","sold",a.muted||"#6b7280",a.primary||"#2563eb"],"circle-radius":12,"circle-stroke-width":3,"circle-stroke-color":"#ffffff","circle-opacity":.9}};console.log("HPHMap: Adding unclustered point layer with config:",o),this.map.addLayer(o),console.log("HPHMap: Unclustered point layer added successfully")}catch(o){console.error("HPHMap: Error adding unclustered point layer:",o);return}console.log("HPHMap: Adding cluster event handlers..."),this.addClusterEventHandlers(t),t.fitBounds&&s.features.length>0&&(console.log("HPHMap: Fitting bounds to show all markers..."),this.fitToGeoJSON(s)),console.log("HPHMap: Clustered markers setup complete")}highlightListingMarker(e){if(!this.map||!e)return;this.unhighlightAllMarkers(),this.map.getSource("highlight-marker")||(this.map.addSource("highlight-marker",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.map.addLayer({id:"highlight-marker-circle",type:"circle",source:"highlight-marker",paint:{"circle-radius":20,"circle-color":"rgba(255, 255, 255, 0.8)","circle-stroke-width":4,"circle-stroke-color":"#ff6b35"}}));const t=this.map.getSource("listings");if(t&&t._data){const a=t._data.features.find(r=>r.properties.id==e);a&&(this.map.getSource("highlight-marker").setData({type:"FeatureCollection",features:[a]}),this.map.easeTo({center:a.geometry.coordinates,zoom:Math.max(this.map.getZoom(),16),duration:1e3}))}}unhighlightAllMarkers(){if(this.map)try{this.map.getSource("highlight-marker")&&this.map.getSource("highlight-marker").setData({type:"FeatureCollection",features:[]})}catch(e){}}showListingPopup(e){if(!this.map||!e)return;const t=this.map.getSource("listings");if(t&&t._data){const a=t._data.features.find(r=>r.properties.id==e);a&&this.createListingPopupFromFeature(a.properties,a.geometry.coordinates).addTo(this.map)}}addClusterEventHandlers(e={}){this.map.on("click","clusters",t=>{const a=this.map.queryRenderedFeatures(t.point,{layers:["clusters"]}),r=a[0].properties.cluster_id;this.map.getSource("listings").getClusterExpansionZoom(r,(s,o)=>{s||this.map.easeTo({center:a[0].geometry.coordinates,zoom:o})})}),this.map.on("click","unclustered-point",t=>{const r=t.features[0].properties;e.showPopup&&this.createListingPopupFromFeature(r,t.lngLat).addTo(this.map),this.map.fire("listing-click",{listing:r,coordinates:t.lngLat}),document.dispatchEvent(new CustomEvent("hph-map-listing-click",{detail:{listingId:r.id,listing:r,coordinates:t.lngLat}}))}),this.map.on("mouseenter","clusters",()=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseleave","clusters",()=>{this.map.getCanvas().style.cursor=""}),this.map.on("mouseenter","unclustered-point",()=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseleave","unclustered-point",()=>{this.map.getCanvas().style.cursor=""})}createListingPopupFromFeature(e,t){const a=new mapboxgl.Popup({offset:25,closeButton:!0,closeOnClick:!1,className:"hph-listing-popup hph-map-card-popup"}),r=this.getHPHColors(),s=e.price?this.formatPrice(e.price):"",o=e.featured_image||"",i=e.title||e.address||"Property",p=e.address||e.street_address||"",h={active:{text:"Active",color:r.secondary},pending:{text:"Pending",color:r.warning},sold:{text:"Sold",color:r.muted},new:{text:"New",color:r.primary}},n=e.status?h[e.status.toLowerCase()]:null,c='\n            <div style="width: 320px; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 10px 25px rgba(0,0,0,0.15);">\n                '.concat(o&&!o.includes("placeholder")?'\n                    <div style="position: relative; height: 200px; overflow: hidden;">\n                        <img src="'.concat(o,'" alt="').concat(i,'" style="width: 100%; height: 100%; object-fit: cover;" loading="lazy">\n                        ').concat(n?'\n                            <div style="position: absolute; top: 12px; left: 12px;">\n                                <span style="background: '.concat(n.color,'; color: white; padding: 4px 8px; border-radius: 6px; font-size: 12px; font-weight: 600;">').concat(n.text,"</span>\n                            </div>\n                        "):"","\n                    </div>\n                "):"",'\n                \n                <div style="padding: 16px;">\n                    <h3 style="margin: 0 0 8px 0; font-size: 18px; font-weight: 600; color: #1f2937;">').concat(i,"</h3>\n                    \n                    ").concat(p?'\n                        <p style="margin: 0 0 12px 0; font-size: 14px; color: #6b7280;">'.concat(p,"</p>\n                    "):"",'\n                    \n                    <div style="font-size: 24px; font-weight: 700; color: ').concat(r.primary,'; margin-bottom: 12px;">').concat(s,"</div>\n                    \n                    ").concat(e.bedrooms||e.bathrooms||e.square_feet?'\n                        <div style="display: flex; gap: 16px; font-size: 14px; color: #6b7280; margin-bottom: 16px;">\n                            '.concat(e.bedrooms?'<div style="display: flex; align-items: center; gap: 4px;"><i class="fas fa-bed"></i><span>'.concat(e.bedrooms," bed</span></div>"):"","\n                            ").concat(e.bathrooms?'<div style="display: flex; align-items: center; gap: 4px;"><i class="fas fa-bath"></i><span>'.concat(e.bathrooms," bath</span></div>"):"","\n                            ").concat(e.square_feet?'<div style="display: flex; align-items: center; gap: 4px;"><i class="fas fa-ruler-combined"></i><span>'.concat(Number(e.square_feet).toLocaleString()," sqft</span></div>"):"","\n                        </div>\n                    "):"","\n                    \n                    ").concat(e.permalink?'\n                        <a href="'.concat(e.permalink,'" style="display: inline-block; background: ').concat(r.primary,'; color: white; padding: 8px 16px; border-radius: 6px; text-decoration: none; font-size: 14px; font-weight: 600;">\n                            View Details â†’\n                        </a>\n                    '):"","\n                </div>\n            </div>\n        ");return a.setLngLat(t).setHTML(c),a}fitToGeoJSON(e){if(!e.features||e.features.length===0)return;const t=new mapboxgl.LngLatBounds;e.features.forEach(a=>{t.extend(a.geometry.coordinates)}),this.map.fitBounds(t,{padding:50,maxZoom:15})}clearMapMarkers(){if(this.map){this.markers&&this.markers.length>0&&(this.markers.forEach(e=>{e.marker&&e.marker.remove&&e.marker.remove()}),this.markers=[]);try{this.map.getLayer("clusters")&&this.map.removeLayer("clusters"),this.map.getLayer("cluster-count")&&this.map.removeLayer("cluster-count"),this.map.getLayer("unclustered-point")&&this.map.removeLayer("unclustered-point"),this.map.getLayer("unclustered-point-label")&&this.map.removeLayer("unclustered-point-label"),this.map.getSource("listings")&&this.map.removeSource("listings")}catch(e){}}}getMarkerTheme(e=null){const t=e||this.options.markerTheme||"happyPlace",a={happyPlace:{active:"#10b981",pending:"#f59e0b",sold:"#ef4444",default:"var(--hph-primary)"},luxury:{active:"#8fbc8f",pending:"#cd853f",sold:"#8b0000",default:"#d4af37"},minimal:{active:"#059669",pending:"#d97706",sold:"#dc2626",default:"#000000"}};return a[t]||a.happyPlace}createListingMarkerElement(e,t){return null}createListingPopup(e,t){const a=new mapboxgl.Popup({offset:t.popupOffset||25,closeButton:!0,closeOnClick:!1,className:"hph-listing-popup hph-map-card-popup"}),r=this.getHPHColors(),s=e.price?this.formatPrice(e.price):"",o=e.featured_image||"",i=e.street_address||"",p=this.formatLocation(e),h={active:{text:"Active",color:r.secondary},pending:{text:"Pending",color:r.warning},sold:{text:"Sold",color:r.muted},new:{text:"New",color:r.primary}},n=e.status?h[e.status.toLowerCase()]:null,c='\n            <div class="hph-card hph-card--elevated hph-bg-white hph-overflow-hidden hph-max-w-80">\n                '.concat(o&&!o.includes("placeholder")?'\n                    <div class="hph-relative hph-h-48 hph-overflow-hidden">\n                        <img src="'.concat(o,'" \n                             alt="').concat(e.title||i||"Property",'" \n                             class="hph-w-full hph-h-full hph-object-cover hph-transition-transform hph-duration-300 hover:hph-scale-105"\n                             loading="lazy"\n                             onerror="this.parentElement.style.display=\'none\'">\n                        \n                        ').concat(n?'\n                            <div class="hph-absolute hph-top-3 hph-left-3">\n                                <span class="hph-inline-flex hph-items-center hph-px-2 hph-py-1 hph-rounded-md hph-text-xs hph-font-semibold hph-shadow-sm"\n                                      style="background-color: '.concat(n.color,'; color: white;">\n                                    ').concat(n.text,"\n                                </span>\n                            </div>\n                        "):"",'\n                        \n                        <button class="hph-absolute hph-top-3 hph-right-3 hph-w-9 hph-h-9 hph-bg-white hph-rounded-full hph-flex hph-items-center hph-justify-center hph-text-gray-500 hover:hph-text-red-500 hph-transition-colors hph-shadow-sm" \n                                data-listing-id="').concat(e.id||"",'" \n                                onclick="event.stopPropagation();">\n                            <i class="fas fa-heart hph-text-sm"></i>\n                        </button>\n                    </div>\n                '):"",'\n                \n                <div class="hph-p-4">\n                    <!-- Price -->\n                    ').concat(s?'\n                        <div class="hph-font-bold hph-text-xl hph-mb-2" style="color: '.concat(r.primary,';">\n                            ').concat(s,"\n                        </div>\n                    "):"",'\n                    \n                    <!-- Street Address -->\n                    <h3 class="hph-text-gray-900 hph-font-semibold hph-text-base hph-mb-1 hph-line-clamp-1">\n                        ').concat(i||e.title||"Property Address","\n                    </h3>\n                    \n                    <!-- Location (if different from street address) -->\n                    ").concat(p&&p!==i?'\n                        <p class="hph-text-sm hph-text-gray-500 hph-mb-3">'.concat(p,"</p>\n                    "):"","\n                    \n                    <!-- Property Details -->\n                    ").concat(e.bedrooms||e.bathrooms||e.square_feet?'\n                        <div class="hph-flex hph-items-center hph-gap-4 hph-text-sm hph-text-gray-600 hph-mb-4">\n                            '.concat(e.bedrooms?'\n                                <div class="hph-flex hph-items-center hph-gap-1">\n                                    <i class="fas fa-bed hph-text-gray-500"></i>\n                                    <span>'.concat(e.bedrooms," bed").concat(e.bedrooms!=1?"s":"","</span>\n                                </div>\n                            "):"","\n                            ").concat(e.bathrooms?'\n                                <div class="hph-flex hph-items-center hph-gap-1">\n                                    <i class="fas fa-bath hph-text-gray-500"></i>\n                                    <span>'.concat(e.bathrooms," bath").concat(e.bathrooms!=1?"s":"","</span>\n                                </div>\n                            "):"","\n                            ").concat(e.square_feet?'\n                                <div class="hph-flex hph-items-center hph-gap-1">\n                                    <i class="fas fa-ruler-combined hph-text-gray-500"></i>\n                                    <span>'.concat(this.formatNumber(e.square_feet)," sq ft</span>\n                                </div>\n                            "):"","\n                        </div>\n                    "):'<div class="hph-mb-4"></div>','\n                    \n                    <!-- Action Button -->\n                    <a href="').concat(e.permalink||"#",'" \n                       class="hph-btn hph-w-full hph-text-center hph-py-3 hph-font-semibold hph-transition-all hph-duration-200 hover:hph-shadow-lg"\n                       style="background-color: ').concat(r.primary,'; color: white; display: inline-block; padding: 8px 16px; border-radius: 6px; text-decoration: none;"\n                       onclick="event.stopPropagation();">\n                        View Details\n                        <i class="fas fa-arrow-right hph-ml-2"></i>\n                    </a>\n                </div>\n            </div>\n        ');return a.setHTML(c),a}addPOIMarker(e,t={}){if(!e.latitude||!e.longitude)return null;const a=new mapboxgl.Marker({color:"#f59e0b"}).setLngLat([parseFloat(e.longitude),parseFloat(e.latitude)]).addTo(this.map);if(t.showPopup!==!1){const r=this.createPOIPopup(e,t);a.setPopup(r)}return this.markers.push({type:"poi",id:e.id||e.name,marker:a,data:e}),a}createPOIMarkerElement(e,t){return null}createPOIPopup(e,t){const a=new mapboxgl.Popup({offset:15,closeButton:!0,className:"hph-poi-popup"}),r='\n            <div class="hph-popup-content">\n                <div class="hph-popup-details">\n                    <h4 class="hph-popup-title">'.concat(e.name||e.title,"</h4>\n                    ").concat(e.type?'<div class="hph-popup-type">'.concat(e.type,"</div>"):"","\n                    ").concat(e.address?'<div class="hph-popup-address">\n                        <i class="fas fa-map-marker-alt"></i>\n                        '.concat(e.address,"\n                    </div>"):"","\n                    ").concat(e.description?'<div class="hph-popup-description">\n                        '.concat(e.description,"\n                    </div>"):"","\n                </div>\n            </div>\n        ");return a.setHTML(r),a}getPOIIcon(e){const t={school:"fas fa-graduation-cap",hospital:"fas fa-hospital",restaurant:"fas fa-utensils",shopping:"fas fa-shopping-bag",park:"fas fa-tree",gas_station:"fas fa-gas-pump",bank:"fas fa-university",gym:"fas fa-dumbbell",pharmacy:"fas fa-pills",default:"fas fa-map-pin"};return t[e]||t.default}fitToMarkers(e=null){const t=e||this.markers.map(r=>r.marker);if(t.length===0)return;if(t.length===1){const r=t[0].getLngLat();this.map.flyTo({center:r,zoom:this.options.zoom});return}const a=new mapboxgl.LngLatBounds;t.forEach(r=>{a.extend(r.getLngLat())}),this.map.fitBounds(a,{padding:50,maxZoom:16})}clearMarkers(e=null){this.markers.forEach((t,a)=>{(!e||t.type===e)&&(t.marker.remove(),this.markers.splice(a,1))})}getMarker(e,t=null){return this.markers.find(a=>a.id===e&&(!t||a.type===t))}showConfigurationMessage(){this.container&&(this.container.innerHTML='\n            <div class="hph-map-error">\n                <div class="hph-map-error-icon">\n                    <i class="fas fa-map-marked-alt"></i>\n                </div>\n                <div class="hph-map-error-message">\n                    <h4>Map Configuration Required</h4>\n                    <p>To enable map view, please configure your Mapbox access token in the Happy Place plugin settings.</p>\n                    <div style="margin-top: 1rem;">\n                        <small style="color: #666; font-style: italic;">\n                            Visit the Happy Place admin panel to add your Mapbox API key.\n                        </small>\n                    </div>\n                </div>\n            </div>\n        ')}showError(e){this.container&&(this.container.innerHTML='\n            <div class="hph-map-error">\n                <div class="hph-map-error-icon">\n                    <i class="fas fa-exclamation-triangle"></i>\n                </div>\n                <div class="hph-map-error-message">\n                    <h4>Map Unavailable</h4>\n                    <p>'.concat(e,"</p>\n                </div>\n            </div>\n        "))}formatPrice(e){const t=parseFloat(e);return isNaN(t)?e:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}formatNumber(e){return new Intl.NumberFormat("en-US").format(e)}formatAddress(e){const t=[];return(e.street_address||e.street_number&&e.street_name)&&t.push(e.street_address||"".concat(e.street_number," ").concat(e.street_name," ").concat(e.street_type||"").trim()),e.city&&t.push(e.city),e.state&&t.push(e.state),e.zip_code&&t.push(e.zip_code),t.join(", ")}formatLocation(e){const t=[];return e.city&&t.push(e.city),e.state&&t.push(e.state),t.join(", ")}setStyle(e,t=null){if(!this.map)return;const a=this.getMapStyle(e);this.map.setStyle(a),this.options.styleTheme=e,t&&(this.options.markerTheme=t,this.updateMarkerThemes())}updateMarkerThemes(){const e=this.getMarkerTheme();this.markers.forEach(t=>{var a;if(t.type==="listing"){const r=t.marker.getElement(),s=t.data,o=e[(a=s.status)==null?void 0:a.toLowerCase()]||e.default;r.style.setProperty("--marker-color",o),r.style.setProperty("--marker-border-color",o),r.className=r.className.replace(/hph-marker-theme--\w+/,""),r.classList.add("hph-marker-theme--".concat(this.options.markerTheme));const i=r.querySelector(".hph-marker-icon");i&&(i.style.backgroundColor=o)}})}addStyleControl(){const e={onAdd:()=>{const t=document.createElement("div");return t.className="mapboxgl-ctrl mapboxgl-ctrl-group hph-style-control",[{name:"Professional",value:"professional",icon:"fas fa-building"},{name:"Luxury",value:"luxury",icon:"fas fa-gem"},{name:"Satellite",value:"satellite",icon:"fas fa-satellite"},{name:"Streets",value:"streets",icon:"fas fa-road"}].forEach(r=>{const s=document.createElement("button");s.type="button",s.innerHTML='<i class="'.concat(r.icon,'"></i>'),s.title=r.name,s.addEventListener("click",()=>{this.setStyle(r.value)}),t.appendChild(s)}),t},onRemove:()=>{}};this.map.addControl(e,"top-left")}toggle3DBuildings(e=!0){this.map&&this.map.on("style.load",()=>{e?this.map.addLayer({id:"add-3d-buildings",source:"composite","source-layer":"building",filter:["==","extrude","true"],type:"fill-extrusion",minzoom:15,paint:{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":.6}}):this.map.getLayer("add-3d-buildings")&&this.map.removeLayer("add-3d-buildings")})}addZipCodeBoundary(e,t){if(!this.map)return;const a=e.filter(r=>r.zip_code&&r.zip_code===t);if(!(a.length<2))try{const r=a.map(i=>[parseFloat(i.longitude),parseFloat(i.latitude)]),s=this.calculateBounds(r),o=this.createBoundingPolygon(s);this.map.getSource("zip-boundary")&&(this.map.removeLayer("zip-boundary-fill"),this.map.removeLayer("zip-boundary-line"),this.map.removeSource("zip-boundary")),this.map.addSource("zip-boundary",{type:"geojson",data:{type:"Feature",geometry:{type:"Polygon",coordinates:[o]},properties:{zipCode:t}}}),this.map.addLayer({id:"zip-boundary-fill",type:"fill",source:"zip-boundary",paint:{"fill-color":"#0ea5e9","fill-opacity":.1}}),this.map.addLayer({id:"zip-boundary-line",type:"line",source:"zip-boundary",paint:{"line-color":"#0ea5e9","line-width":2,"line-dasharray":[2,2]}})}catch(r){}}calculateBounds(e){let t=1/0,a=-1/0,r=1/0,s=-1/0;return e.forEach(([o,i])=>{t=Math.min(t,o),a=Math.max(a,o),r=Math.min(r,i),s=Math.max(s,i)}),{minLng:t,maxLng:a,minLat:r,maxLat:s}}createBoundingPolygon(e){const a=e.minLng-.005,r=e.maxLng+.005,s=e.minLat-.005,o=e.maxLat+.005;return[[a,s],[r,s],[r,o],[a,o],[a,s]]}removeZipCodeBoundary(){if(this.map)try{this.map.getSource("zip-boundary")&&(this.map.removeLayer("zip-boundary-fill"),this.map.removeLayer("zip-boundary-line"),this.map.removeSource("zip-boundary"))}catch(e){}}clearMarkers(){if(this.map){this.markers&&this.markers.length>0&&(this.markers.forEach(e=>{e.marker&&e.marker.remove&&e.marker.remove()}),this.markers=[]);try{this.map.getLayer("clusters")&&this.map.removeLayer("clusters"),this.map.getLayer("cluster-count")&&this.map.removeLayer("cluster-count"),this.map.getLayer("unclustered-point")&&this.map.removeLayer("unclustered-point"),this.map.getLayer("unclustered-point-label")&&this.map.removeLayer("unclustered-point-label"),this.map.getSource("listings")&&this.map.removeSource("listings")}catch(e){}}}destroy(){this.map&&(this.clearMapMarkers(),this.removeZipCodeBoundary(),this.map.remove(),this.map=null)}}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-hph-map]").forEach(e=>{if(!e.hasAttribute("data-archive-map"))try{const t={};e.dataset.mapCenter&&(t.center=JSON.parse(e.dataset.mapCenter)),e.dataset.mapZoom&&(t.zoom=parseInt(e.dataset.mapZoom)),e.dataset.mapStyle&&(t.style=e.dataset.mapStyle);const a=new l(e,t);if(e.dataset.mapListings){const r=JSON.parse(e.dataset.mapListings),s={fitBounds:r.length>1};e.dataset.showZipBoundary&&e.dataset.zipCode&&(s.showZipBoundary=!0,s.zipCode=e.dataset.zipCode),a.addListingMarkers(r,s)}e.dataset.mapPois&&JSON.parse(e.dataset.mapPois).forEach(s=>a.addPOIMarker(s)),e.hphMap=a}catch(t){}})}),typeof module<"u"&&module.exports?module.exports=l:window.HPHMap=l}window.hphDebug&&console.log("HPH Unified Archive Bundle Loaded - Filter/Pagination/Search Redundancies Eliminated");export{u as __vite_legacy_guard};
