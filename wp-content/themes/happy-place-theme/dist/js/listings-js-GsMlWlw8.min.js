var P=Object.defineProperty;var H=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var w=(t,e,n)=>e in t?P(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,f=(t,e)=>{for(var n in e||(e={}))C.call(e,n)&&w(t,n,e[n]);if(H)for(var n of H(e))x.call(e,n)&&w(t,n,e[n]);return t};window.HPH?(HPH.register("gallery",function(){return{instances:new Map,init:function(t,e={}){const n=t.querySelector(".hph-gallery, .listing-gallery, .property-gallery");if(!n)return;const a=n.id||"gallery-"+Date.now();if(this.instances.has(a))return this.instances.get(a);const i=f({autoplay:!1,loop:!0,navigation:!0,pagination:!0,touchSwipe:!0,lazy:!0,breakpoints:{768:{slidesPerView:1},1024:{slidesPerView:2},1200:{slidesPerView:3}}},e),r=this.createGallery(n,i);return this.instances.set(a,r),r},createGallery:function(t,e){const n=Array.from(t.querySelectorAll(".gallery-slide, .listing-image, .property-image"));let a=0;return this.ensureControls(t),e.touchSwipe&&this.initTouchSwipe(t,()=>this.next(t),()=>this.prev(t)),e.lazy&&this.initLazyLoading(t),{gallery:t,slides:n,currentSlide:a,next:()=>this.next(t),prev:()=>this.prev(t),goTo:i=>this.goTo(t,i),destroy:()=>this.destroy(t)}},ensureControls:function(t){if(!t.querySelector(".gallery-nav")){const e=document.createElement("div");e.className="gallery-nav",e.innerHTML='\n                        <button class="gallery-prev" aria-label="Previous image">‹</button>\n                        <button class="gallery-next" aria-label="Next image">›</button>\n                    ',t.appendChild(e)}},initTouchSwipe:function(t,e,n){let a=0,i=0;t.addEventListener("touchstart",r=>{a=r.touches[0].clientX,i=r.touches[0].clientY}),t.addEventListener("touchend",r=>{const o=r.changedTouches[0].clientX,h=r.changedTouches[0].clientY,p=a-o,c=i-h;Math.abs(p)>Math.abs(c)&&Math.abs(p)>50&&(p>0?e():n())})},initLazyLoading:function(t){const e=t.querySelectorAll("img[data-src]");if("IntersectionObserver"in window){const n=new IntersectionObserver(a=>{a.forEach(i=>{if(i.isIntersecting){const r=i.target;r.src=r.dataset.src,r.removeAttribute("data-src"),n.unobserve(r)}})});e.forEach(a=>n.observe(a))}},next:function(t){const e=t.querySelectorAll(".gallery-slide, .listing-image, .property-image"),n=t.querySelector(".active")||e[0],i=(Array.from(e).indexOf(n)+1)%e.length;this.goTo(t,i)},prev:function(t){const e=t.querySelectorAll(".gallery-slide, .listing-image, .property-image"),n=t.querySelector(".active")||e[0],a=Array.from(e).indexOf(n),i=a===0?e.length-1:a-1;this.goTo(t,i)},goTo:function(t,e){t.querySelectorAll(".gallery-slide, .listing-image, .property-image").forEach((a,i)=>{a.classList.toggle("active",i===e)})}}}),HPH.register("maps",function(){return{instances:new Map,init:function(t,e={}){const n=t.querySelector(".hph-map, .listing-map, .property-map, .neighborhood-map");if(!n)return;const a=n.id||"map-"+Date.now();if(this.instances.has(a))return this.instances.get(a);const i=f({center:[39.8283,-98.5795],zoom:13,showNeighborhood:!0,showMarkers:!0,clusterMarkers:!0},e),r=this.createMap(n,i);return this.instances.set(a,r),r},createMap:function(t,e){if(window.L){const n=L.map(t).setView(e.center,e.zoom);return L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors"}).addTo(n),e.showMarkers&&this.addMarkers(n,t),{map:n,addMarker:(a,i,r)=>this.addMarker(n,a,i,r),destroy:()=>n.remove()}}else return t.innerHTML="<p>Map functionality requires location data</p>",{map:null}},addMarkers:function(t,e){const n=e.dataset.markers;if(n)try{JSON.parse(n).forEach(i=>{L.marker([i.lat,i.lng]).bindPopup(i.popup||"").addTo(t)})}catch(a){console.warn("Invalid marker data:",a)}},addMarker:function(t,e,n,a={}){return L.marker([e,n],a).addTo(t)}}}),HPH.register("listingForms",function(){return{init:function(t){t.querySelectorAll(".listing-contact-form, .property-inquiry-form, .showing-request-form").forEach(n=>this.initForm(n))},initForm:function(t){t.dataset.hphInitialized||(t.addEventListener("submit",e=>{e.preventDefault(),this.submitForm(t)}),this.populateListingData(t),t.dataset.hphInitialized="true")},populateListingData:function(t){var a,i,r;const e=(a=t.closest("[data-listing-id]"))==null?void 0:a.dataset.listingId,n=(i=document.querySelector(".listing-title, .property-title"))==null?void 0:i.textContent;if((r=document.querySelector(".listing-price, .property-price"))==null||r.textContent,e){const o=t.querySelector('input[name="listing_id"]');o&&(o.value=e)}if(n){const o=t.querySelector('input[name="subject"]');o&&!o.value&&(o.value="Inquiry about: ".concat(n))}},submitForm:function(t){const e=new FormData(t);e.append("action","hph_listing_contact"),e.append("nonce",window.hphNonce||""),window.HPH&&window.HPH.ajax&&window.HPH.ajax.submitForm(t,{data:e,onSuccess:n=>this.handleSuccess(t,n),onError:n=>this.handleError(t,n)})},handleSuccess:function(t,e){t.innerHTML='<div class="hph-alert hph-alert-success">Thank you! Your message has been sent.</div>'},handleError:function(t,e){const n=t.querySelector(".form-error")||document.createElement("div");n.className="hph-alert hph-alert-error",n.textContent="Sorry, there was an error sending your message. Please try again.",t.insertBefore(n,t.firstChild)}}}),HPH.register("listingFilters",function(){return{init:function(t){t.querySelectorAll(".listing-filters, .search-filters, .archive-filters").forEach(n=>this.initFilters(n))},initFilters:function(t){if(t.dataset.hphInitialized)return;t.querySelectorAll("input, select").forEach(a=>{a.addEventListener("change",()=>this.applyFilters(t))}),t.querySelectorAll('input[type="range"]').forEach(a=>{a.addEventListener("input",()=>this.updatePriceDisplay(a))}),t.dataset.hphInitialized="true"},applyFilters:function(t){const e=new FormData(t),n=Object.fromEntries(e.entries());window.HPH&&window.HPH.ajax&&window.HPH.ajax.request({action:"hph_filter_listings",filters:n,nonce:window.hphNonce||""},{onSuccess:a=>this.updateResults(a),onError:a=>console.warn("Filter error:",a)})},updatePriceDisplay:function(t){const e=t.nextElementSibling||t.parentNode.querySelector(".price-display");if(e){const n=parseInt(t.value);e.textContent=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}).format(n)}},updateResults:function(t){const e=document.querySelector(".listing-results, .search-results, .archive-content");e&&t.html&&(e.innerHTML=t.html,this.initNewContent(e))},initNewContent:function(t){window.HPH&&(window.HPH.modules.gallery&&window.HPH.modules.gallery.init(t),window.HPH.modules.listingForms&&window.HPH.modules.listingForms.init(t))}}}),HPH.register("virtualTours",function(){return{init:function(t){t.querySelectorAll(".virtual-tour, .tour-iframe, .matterport-tour").forEach(n=>this.initTour(n))},initTour:function(t){if(t.dataset.hphInitialized)return;const e=t.dataset.tourUrl,n=t.dataset.tourType||"iframe";e&&this.loadTour(t,e,n),t.dataset.hphInitialized="true"},loadTour:function(t,e,n){switch(n){case"matterport":this.loadMatterport(t,e);break;case"youtube":this.loadYoutube(t,e);break;default:this.loadIframe(t,e)}},loadIframe:function(t,e){const n=document.createElement("iframe");n.src=e,n.width="100%",n.height="400",n.frameBorder="0",n.allowFullscreen=!0,t.appendChild(n)},loadMatterport:function(t,e){this.loadIframe(t,e)},loadYoutube:function(t,e){const n=this.extractYouTubeId(e);n&&this.loadIframe(t,"https://www.youtube.com/embed/".concat(n))},extractYouTubeId:function(t){const e=/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/,n=t.match(e);return n?n[1]:null}}}),HPH.register("listingComparison",function(){return{compareList:[],maxCompare:3,init:function(t){t.querySelectorAll(".compare-listing, [data-compare]").forEach(n=>this.initCompareButton(n)),this.updateCompareDisplay()},initCompareButton:function(t){t.addEventListener("click",e=>{e.preventDefault();const n=t.dataset.listingId||t.dataset.compare;this.toggleCompare(n,t)})},toggleCompare:function(t,e){const n=this.compareList.indexOf(t);n>-1?(this.compareList.splice(n,1),e.classList.remove("active")):this.compareList.length<this.maxCompare?(this.compareList.push(t),e.classList.add("active")):alert("You can only compare up to ".concat(this.maxCompare," listings.")),this.updateCompareDisplay()},updateCompareDisplay:function(){const t=document.querySelector(".compare-widget");if(t){const e=this.compareList.length;t.style.display=e>0?"block":"none";const n=t.querySelector(".compare-count");n&&(n.textContent=e)}},viewComparison:function(){if(this.compareList.length<2){alert("Please select at least 2 listings to compare.");return}const t="/compare-listings/?ids=".concat(this.compareList.join(","));window.location.href=t},clearComparison:function(){this.compareList=[],document.querySelectorAll(".compare-listing.active").forEach(t=>{t.classList.remove("active")}),this.updateCompareDisplay()}}}),HPH.register("initListings",function(){return{init:function(t=document){window.HPH.modules.gallery&&window.HPH.modules.gallery.init(t),window.HPH.modules.heroGallery&&window.HPH.modules.heroGallery.init(t),window.HPH.modules.maps&&window.HPH.modules.maps.init(t),window.HPH.modules.listingForms&&window.HPH.modules.listingForms.init(t),window.HPH.modules.listingFilters&&window.HPH.modules.listingFilters.init(t),window.HPH.modules.virtualTours&&window.HPH.modules.virtualTours.init(t),window.HPH.modules.listingComparison&&window.HPH.modules.listingComparison.init(t)}}})):console.warn("HPH Core system not found. Listing modules require unified core.");window.hphDebug&&console.log("Unified Listings System Loaded - All redundancies eliminated");(function(t){HPH.MortgageCalculator={init:function(){this.initCalculators(),this.initAffordabilityCalculator(),this.initPrequalificationForm()},initCalculators:function(){t(".mortgage-calculator").each(function(){var e=t(this);HPH.MortgageCalculator.setupCalculator(e)})},setupCalculator:function(e){var n=e.find("input, select"),a=e.find(".calculate-payment");e.find("#payment-result"),n.on("input change",HPH.debounce(function(){HPH.MortgageCalculator.calculatePayment(e)},500)),a.on("click",function(i){i.preventDefault(),HPH.MortgageCalculator.calculatePayment(e)}),HPH.MortgageCalculator.calculatePayment(e)},calculatePayment:function(e){var n=parseFloat(e.find("#loan-amount").val())||0,a=parseFloat(e.find("#interest-rate").val())||0,i=parseInt(e.find("#loan-term").val())||30,r=parseFloat(e.find("#down-payment").val())||0,o=parseFloat(e.find("#property-tax").val())||0,h=parseFloat(e.find("#home-insurance").val())||0,p=parseFloat(e.find("#pmi").val())||0,c=parseFloat(e.find("#hoa-fees").val())||0,l=n-r,u=a/100/12,s=i*12,d=0;u>0&&s>0?d=l*(u*Math.pow(1+u,s))/(Math.pow(1+u,s)-1):l>0&&s>0&&(d=l/s);var m=o/12,y=h/12,g=p/12,v=c/12,b=d+m+y+g+v;HPH.MortgageCalculator.displayResults(e,{principalInterest:d,propertyTax:m,insurance:y,pmi:g,hoaFees:v,totalPayment:b,loanAmount:n,downPayment:r,principal:l})},displayResults:function(e,n){var a=e.find("#payment-result");if(n.totalPayment<=0){a.html('<p class="hph-text-gray-600">Please enter valid loan details to calculate payment.</p>').removeClass("hph-hidden");return}var i='\n                <div class="mortgage-results hph-space-y-4">\n                    <div class="total-payment hph-text-center hph-p-4 hph-bg-primary-50 hph-rounded-lg">\n                        <div class="hph-text-sm hph-text-gray-600 hph-mb-1">Total Monthly Payment</div>\n                        <div class="hph-text-3xl hph-font-bold hph-text-primary-600">\n                            '.concat(HPH.MortgageCalculator.formatCurrency(n.totalPayment),'\n                        </div>\n                    </div>\n                    \n                    <div class="payment-breakdown hph-space-y-2">\n                        <h4 class="hph-font-semibold hph-mb-3">Payment Breakdown</h4>\n                        \n                        <div class="breakdown-item hph-flex hph-justify-between">\n                            <span>Principal & Interest</span>\n                            <span class="hph-font-medium">').concat(HPH.MortgageCalculator.formatCurrency(n.principalInterest),"</span>\n                        </div>\n                        \n                        ").concat(n.propertyTax>0?'\n                        <div class="breakdown-item hph-flex hph-justify-between">\n                            <span>Property Tax</span>\n                            <span class="hph-font-medium">'.concat(HPH.MortgageCalculator.formatCurrency(n.propertyTax),"</span>\n                        </div>\n                        "):"","\n                        \n                        ").concat(n.insurance>0?'\n                        <div class="breakdown-item hph-flex hph-justify-between">\n                            <span>Home Insurance</span>\n                            <span class="hph-font-medium">'.concat(HPH.MortgageCalculator.formatCurrency(n.insurance),"</span>\n                        </div>\n                        "):"","\n                        \n                        ").concat(n.pmi>0?'\n                        <div class="breakdown-item hph-flex hph-justify-between">\n                            <span>PMI</span>\n                            <span class="hph-font-medium">'.concat(HPH.MortgageCalculator.formatCurrency(n.pmi),"</span>\n                        </div>\n                        "):"","\n                        \n                        ").concat(n.hoaFees>0?'\n                        <div class="breakdown-item hph-flex hph-justify-between">\n                            <span>HOA Fees</span>\n                            <span class="hph-font-medium">'.concat(HPH.MortgageCalculator.formatCurrency(n.hoaFees),"</span>\n                        </div>\n                        "):"",'\n                    </div>\n                    \n                    <div class="loan-summary hph-pt-4 hph-border-t hph-space-y-2">\n                        <h4 class="hph-font-semibold hph-mb-3">Loan Summary</h4>\n                        \n                        <div class="summary-item hph-flex hph-justify-between">\n                            <span>Home Price</span>\n                            <span class="hph-font-medium">').concat(HPH.MortgageCalculator.formatCurrency(n.loanAmount),'</span>\n                        </div>\n                        \n                        <div class="summary-item hph-flex hph-justify-between">\n                            <span>Down Payment</span>\n                            <span class="hph-font-medium">').concat(HPH.MortgageCalculator.formatCurrency(n.downPayment),'</span>\n                        </div>\n                        \n                        <div class="summary-item hph-flex hph-justify-between">\n                            <span>Loan Amount</span>\n                            <span class="hph-font-medium">').concat(HPH.MortgageCalculator.formatCurrency(n.principal),'</span>\n                        </div>\n                    </div>\n                    \n                    <div class="calculator-actions hph-pt-4 hph-space-y-2">\n                        <button type="button" class="get-prequalified hph-btn hph-btn-primary hph-w-full">\n                            Get Pre-qualified\n                        </button>\n                        <button type="button" class="contact-lender hph-btn hph-btn-outline hph-w-full">\n                            Contact a Lender\n                        </button>\n                    </div>\n                </div>\n            ');a.html(i).removeClass("hph-hidden"),a.find(".get-prequalified").on("click",function(){HPH.MortgageCalculator.showPrequalificationForm(n)}),a.find(".contact-lender").on("click",function(){HPH.MortgageCalculator.contactLender(n)})},initAffordabilityCalculator:function(){t(".affordability-calculator").each(function(){var e=t(this),n=e.find("input, select"),a=e.find(".calculate-affordability");n.on("input change",HPH.debounce(function(){HPH.MortgageCalculator.calculateAffordability(e)},500)),a.on("click",function(i){i.preventDefault(),HPH.MortgageCalculator.calculateAffordability(e)})})},calculateAffordability:function(e){var n=parseFloat(e.find("#annual-income").val())||0,a=parseFloat(e.find("#monthly-debts").val())||0,i=parseFloat(e.find("#down-payment-affordability").val())||0,r=parseFloat(e.find("#interest-rate-affordability").val())||3.5,o=parseInt(e.find("#loan-term-affordability").val())||30,h=n/12,p=h*.28,c=p-a;if(c<=0){e.find("#affordability-result").html('<p class="hph-text-red-600">Based on your current debt, you may need to reduce monthly obligations before purchasing a home.</p>').removeClass("hph-hidden");return}var l=r/100/12,u=o*12,s=0;l>0?s=c*(Math.pow(1+l,u)-1)/(l*Math.pow(1+l,u)):s=c*u;var d=s+i,m='\n                <div class="affordability-results hph-space-y-4">\n                    <div class="max-price hph-text-center hph-p-4 hph-bg-green-50 hph-rounded-lg">\n                        <div class="hph-text-sm hph-text-gray-600 hph-mb-1">Maximum Home Price</div>\n                        <div class="hph-text-3xl hph-font-bold hph-text-green-600">\n                            '.concat(HPH.MortgageCalculator.formatCurrency(d),'\n                        </div>\n                    </div>\n                    \n                    <div class="affordability-breakdown hph-space-y-2">\n                        <div class="breakdown-item hph-flex hph-justify-between">\n                            <span>Maximum Monthly Payment</span>\n                            <span class="hph-font-medium">').concat(HPH.MortgageCalculator.formatCurrency(c),'</span>\n                        </div>\n                        <div class="breakdown-item hph-flex hph-justify-between">\n                            <span>Maximum Loan Amount</span>\n                            <span class="hph-font-medium">').concat(HPH.MortgageCalculator.formatCurrency(s),'</span>\n                        </div>\n                        <div class="breakdown-item hph-flex hph-justify-between">\n                            <span>Down Payment</span>\n                            <span class="hph-font-medium">').concat(HPH.MortgageCalculator.formatCurrency(i),"</span>\n                        </div>\n                    </div>\n                </div>\n            ");e.find("#affordability-result").html(m).removeClass("hph-hidden")},initPrequalificationForm:function(){t(document).on("click",".get-prequalified",function(e){e.preventDefault(),HPH.showAlert("Prequalification form would open here","info")})},showPrequalificationForm:function(e){var n='\n                <div id="prequalification-modal" class="hph-modal">\n                    <div class="hph-modal-content">\n                        <div class="hph-modal-header">\n                            <h3>Get Pre-qualified</h3>\n                            <button type="button" class="hph-modal-close">&times;</button>\n                        </div>\n                        <div class="hph-modal-body">\n                            <p>Based on your calculation, you\'re looking at a monthly payment of approximately <strong>'.concat(HPH.MortgageCalculator.formatCurrency(e.totalPayment),'</strong>.</p>\n                            <p>Would you like to get pre-qualified with one of our preferred lenders?</p>\n                            <form class="prequalification-form hph-space-y-4">\n                                <div class="hph-form-group">\n                                    <label class="hph-label">Full Name</label>\n                                    <input type="text" class="hph-input" required>\n                                </div>\n                                <div class="hph-form-group">\n                                    <label class="hph-label">Email</label>\n                                    <input type="email" class="hph-input" required>\n                                </div>\n                                <div class="hph-form-group">\n                                    <label class="hph-label">Phone</label>\n                                    <input type="tel" class="hph-input" required>\n                                </div>\n                                <button type="submit" class="hph-btn hph-btn-primary hph-w-full">\n                                    Submit Pre-qualification Request\n                                </button>\n                            </form>\n                        </div>\n                    </div>\n                </div>\n            ');t("body").append(n),HPH.openModal("prequalification-modal"),t(".prequalification-form").on("submit",function(a){a.preventDefault(),HPH.showAlert("Pre-qualification request submitted!","success"),HPH.closeModal(),setTimeout(function(){t("#prequalification-modal").remove()},500)})},contactLender:function(e){HPH.showAlert("Contact lender functionality would be implemented here","info")},formatCurrency:function(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)},formatPercentage:function(e){return e.toFixed(3)+"%"}},t(document).ready(function(){HPH.MortgageCalculator.init()})})(jQuery);window.hphDebug&&console.log("HPH Unified Listings Bundle Loaded - Gallery/Map/Filter Redundancies Eliminated");
