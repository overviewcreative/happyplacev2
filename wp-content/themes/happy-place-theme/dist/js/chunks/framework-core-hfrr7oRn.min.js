var p=Object.defineProperty;var f=Object.getOwnPropertySymbols;var g=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable;var m=(o,e,t)=>e in o?p(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,u=(o,e)=>{for(var t in e||(e={}))g.call(e,t)&&m(o,t,e[t]);if(f)for(var t of f(e))v.call(e,t)&&m(o,t,e[t]);return o};var b=(o,e)=>()=>(e||o((e={exports:{}}).exports,e),e.exports);var H=b((F,h)=>{(function(o){window.HPH=window.HPH||{initialized:!1,modules:new Map,config:{},register:function(e,t){if(this.modules.set(e,t),this.initialized)try{t(this.config)}catch(i){console.error("Error initializing late module ".concat(e,":"),i)}},init:function(e={}){this.initialized||(this.config=u(u({},this.getDefaultConfig()),e),this.initCore(),this.initModules(),this.initEventListeners(),this.initialized=!0,o(document).trigger("hph:initialized"),this.config.debug&&console.log("HPH Core initialized with",this.modules.size,"modules"))},initModules:function(){this.modules.forEach((e,t)=>{try{if(typeof e=="function"){const i=e(this.config);i&&typeof i.init=="function"&&i.init()}}catch(i){console.error("Error initializing module ".concat(t,":"),i)}}),this.initUniversalCarousels()},events:{on:function(e,t,i,s={}){if(!e||!t||!i){console.warn("HPH.events.on: Missing required parameters");return}if(NodeList.prototype.isPrototypeOf(e)||Array.isArray(e)){Array.from(e).forEach(n=>{this.on(n,t,i,s)});return}e.addEventListener?e.addEventListener(t,i,s):e.attachEvent&&e.attachEvent("on"+t,i)},off:function(e,t,i,s={}){if(!e||!t||!i){console.warn("HPH.events.off: Missing required parameters");return}if(NodeList.prototype.isPrototypeOf(e)||Array.isArray(e)){Array.from(e).forEach(n=>{this.off(n,t,i,s)});return}e.removeEventListener?e.removeEventListener(t,i,s):e.detachEvent&&e.detachEvent("on"+t,i)},trigger:function(e,t,i={}){if(!e||!t){console.warn("HPH.events.trigger: Missing required parameters");return}let s;typeof CustomEvent=="function"?s=new CustomEvent(t,{detail:i,bubbles:!0,cancelable:!0}):(s=document.createEvent("CustomEvent"),s.initCustomEvent(t,!0,!0,i)),e.dispatchEvent(s)},delegate:function(e,t,i,s){this.on(e,i,function(n){(n.target.matches(t)||n.target.closest(t))&&s.call(n.target.closest(t),n)})}},getDefaultConfig:function(){return{ajaxUrl:window.ajaxurl||"/wp-admin/admin-ajax.php",nonce:window.hphNonce||"",debug:window.hphDebug||!1,selectors:{forms:"[data-route-type], .hph-form, .hph-general-contact-form, .hph-property-inquiry-form, .hph-agent-contact-form",navigation:".hph-navigation, .hph-mobile-menu",modals:".hph-modal",cards:".hph-card",galleries:".hph-gallery",maps:".hph-map"},classes:{loading:"hph-loading",error:"is-invalid",success:"is-valid",active:"active"}}},initCore:function(){this.initUnifiedFormSystem(),this.initUnifiedNavigation(),this.initUnifiedNotifications(),this.initUnifiedAjax(),this.initUnifiedUtils()},initUnifiedFormSystem:function(){const e=document.querySelectorAll(this.config.selectors.forms);this.forms={validators:{required:t=>t.trim()!=="",email:t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t),phone:t=>/^[\d\s\-\+\(\)\.]+$/.test(t),url:t=>/^https?:\/\/.+/.test(t),number:t=>!isNaN(t)&&t!=="",minLength:(t,i)=>t.length>=i,maxLength:(t,i)=>t.length<=i},validateField:function(t){const i=t.value.trim();let s=!0,n="";if(t.hasAttribute("required")&&!HPH.forms.validators.required(i)&&(s=!1,n="This field is required"),i&&s)switch(t.type){case"email":HPH.forms.validators.email(i)||(s=!1,n="Please enter a valid email address");break;case"tel":HPH.forms.validators.phone(i)||(s=!1,n="Please enter a valid phone number");break;case"url":HPH.forms.validators.url(i)||(s=!1,n="Please enter a valid URL");break;case"number":HPH.forms.validators.number(i)||(s=!1,n="Please enter a valid number");break}if(i&&s){const a=t.getAttribute("data-min-length");a&&!HPH.forms.validators.minLength(i,parseInt(a))&&(s=!1,n="Minimum ".concat(a," characters required"));const r=t.getAttribute("data-max-length");r&&!HPH.forms.validators.maxLength(i,parseInt(r))&&(s=!1,n="Maximum ".concat(r," characters allowed"))}return HPH.forms.toggleFieldError(t,s,n),s},validateForm:function(t){let i=!0;return t.querySelectorAll("input, select, textarea").forEach(n=>{HPH.forms.validateField(n)||(i=!1)}),i},toggleFieldError:function(t,i,s){const n=t.closest(".hph-form-field")||t.parentElement;if(i){t.classList.remove(HPH.config.classes.error),t.classList.add(HPH.config.classes.success),n.classList.remove("has-error");const a=n.querySelector(".hph-field-error");a&&a.remove()}else{t.classList.remove(HPH.config.classes.success),t.classList.add(HPH.config.classes.error),n.classList.add("has-error");let a=n.querySelector(".hph-field-error");a||(a=document.createElement("div"),a.className="hph-field-error",n.appendChild(a)),a.textContent=s}},submitForm:function(t,i={}){const s=t.getAttribute("data-action")||"hph_form_submit",n=t.hasAttribute("data-ajax")||t.classList.contains("hph-ajax-form");return HPH.forms.validateForm(t)?n?HPH.ajax.submitForm(t,u({action:s},i)):!0:!1}},e.forEach(t=>{t.addEventListener("submit",function(s){HPH.forms.submitForm(this)||s.preventDefault()}),t.querySelectorAll("input, select, textarea").forEach(s=>{s.addEventListener("blur",function(){HPH.forms.validateField(this)})})})},initUnifiedNavigation:function(){this.navigation={initMobileMenu:function(){const e=document.querySelector(".hph-mobile-menu-toggle"),t=document.querySelector(".hph-mobile-menu");e&&t&&e.addEventListener("click",function(){t.classList.toggle(HPH.config.classes.active),document.body.classList.toggle("mobile-menu-open"),this.setAttribute("aria-expanded",t.classList.contains(HPH.config.classes.active))})},initDropdowns:function(){document.querySelectorAll(".hph-dropdown-toggle").forEach(t=>{t.addEventListener("click",function(i){i.preventDefault();const s=this.nextElementSibling;s&&s.classList.contains("hph-dropdown-menu")&&(document.querySelectorAll(".hph-dropdown-menu.active").forEach(n=>{n!==s&&n.classList.remove(HPH.config.classes.active)}),s.classList.toggle(HPH.config.classes.active))})}),document.addEventListener("click",function(t){t.target.closest(".hph-dropdown")||document.querySelectorAll(".hph-dropdown-menu.active").forEach(i=>{i.classList.remove(HPH.config.classes.active)})})},initSearch:function(){document.querySelectorAll(".hph-search-form").forEach(t=>{const i=t.querySelector('input[type="search"]');i&&i.hasAttribute("data-autocomplete")&&HPH.navigation.initSearchAutocomplete(i)})},initSearchAutocomplete:function(e){let t;e.addEventListener("input",function(){clearTimeout(t);const i=this.value.trim();i.length>=3&&(t=setTimeout(()=>{HPH.ajax.request({data:{action:"hph_search_autocomplete",query:i}}).done(function(s){s.success&&HPH.navigation.showSearchSuggestions(e,s.data)})},300))})},showSearchSuggestions:function(e,t){let i=e.parentElement.querySelector(".hph-search-suggestions");i||(i=document.createElement("div"),i.className="hph-search-suggestions",e.parentElement.appendChild(i)),t.length>0?(i.innerHTML=t.map(s=>'<div class="hph-search-suggestion" data-value="'.concat(s.title,'">\n                                <span class="suggestion-title">').concat(s.title,'</span>\n                                <span class="suggestion-type">').concat(s.type,"</span>\n                            </div>")).join(""),i.style.display="block",i.querySelectorAll(".hph-search-suggestion").forEach(s=>{s.addEventListener("click",function(){e.value=this.getAttribute("data-value"),i.style.display="none"})})):i.style.display="none"}},this.navigation.initMobileMenu(),this.navigation.initDropdowns(),this.navigation.initSearch()},initUnifiedNotifications:function(){this.notifications={container:null,init:function(){this.container=document.querySelector(".hph-notifications"),this.container||(this.container=document.createElement("div"),this.container.className="hph-notifications",document.body.appendChild(this.container))},show:function(e,t="info",i=5e3){this.container||this.init();const s=document.createElement("div");return s.className="hph-notification hph-notification--".concat(t),s.innerHTML='\n                        <div class="hph-notification__content">\n                            <span class="hph-notification__message">'.concat(e,'</span>\n                            <button type="button" class="hph-notification__close" aria-label="Close">&times;</button>\n                        </div>\n                    '),this.container.appendChild(s),i>0&&setTimeout(()=>{s.parentNode&&s.remove()},i),s.querySelector(".hph-notification__close").addEventListener("click",()=>{s.remove()}),s},success:function(e,t){return this.show(e,"success",t)},error:function(e,t){return this.show(e,"error",t)},warning:function(e,t){return this.show(e,"warning",t)},info:function(e,t){return this.show(e,"info",t)}}},initUnifiedAjax:function(){this.ajax={request:function(e){const t={url:HPH.config.ajaxUrl,method:"POST",dataType:"json",data:{nonce:HPH.config.nonce},timeout:3e4},i=u(u({},t),e);return o.ajax(i).fail(function(s,n,a){var c,l;const r=((l=(c=s.responseJSON)==null?void 0:c.data)==null?void 0:l.message)||"An error occurred. Please try again.";HPH.config.debug&&console.error("AJAX Error:",{status:n,error:a,response:s.responseText}),HPH.notifications.error(r)})},submitForm:function(e,t={}){const i=new FormData(e),s=u({},t);for(let[n,a]of i.entries())s[n]=a;return this.request({data:s,beforeSend:function(){e.classList.add(HPH.config.classes.loading);const n=e.querySelector('button[type="submit"]');n&&(n.disabled=!0,n.setAttribute("data-original-text",n.textContent),n.textContent="Submitting...")},complete:function(){e.classList.remove(HPH.config.classes.loading);const n=e.querySelector('button[type="submit"]');if(n){n.disabled=!1;const a=n.getAttribute("data-original-text");a&&(n.textContent=a)}}}).done(function(n){n.success?(HPH.notifications.success(n.data.message||"Form submitted successfully"),e.reset(),o(e).trigger("hph:form:success",n)):(HPH.notifications.error(n.data.message||"Form submission failed"),o(e).trigger("hph:form:error",n))})},loadContent:function(e,t,i={}){const s=document.querySelector(e);if(s)return this.request({url:t,data:u({action:"hph_load_content"},i),beforeSend:function(){s.classList.add(HPH.config.classes.loading)},complete:function(){s.classList.remove(HPH.config.classes.loading)}}).done(function(n){n.success&&(s.innerHTML=n.data.content,HPH.initDynamicContent(s))})}}},initUnifiedUtils:function(){this.debounce=function(e,t,i){let s;return function(){const a=this,r=arguments,c=function(){s=null,i||e.apply(a,r)},l=i&&!s;clearTimeout(s),s=setTimeout(c,t),l&&e.apply(a,r)}},this.throttle=function(e,t){let i;return function(){const s=arguments,n=this;i||(e.apply(n,s),i=!0,setTimeout(()=>i=!1,t))}},this.utils={debounce:this.debounce,throttle:this.throttle,isInViewport:function(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)},lazyLoad:function(e,t,i={}){const n=u(u({},{root:null,rootMargin:"50px",threshold:.1}),i),a=new IntersectionObserver(r=>{r.forEach(c=>{c.isIntersecting&&(t(c.target),a.unobserve(c.target))})},n);return document.querySelectorAll(e).forEach(r=>{a.observe(r)}),a}}},initEventListeners:function(){document.addEventListener("keydown",function(e){if(e.key==="Escape"){document.querySelectorAll(".hph-modal.active").forEach(i=>{i.classList.remove(HPH.config.classes.active)}),document.querySelectorAll(".hph-dropdown-menu.active").forEach(i=>{i.classList.remove(HPH.config.classes.active)});const t=document.querySelector(".hph-mobile-menu.active");t&&(t.classList.remove(HPH.config.classes.active),document.body.classList.remove("mobile-menu-open"))}}),document.addEventListener("click",function(e){if(e.target.matches("[data-modal-target]")){e.preventDefault();const t=e.target.getAttribute("data-modal-target"),i=document.querySelector(t);i&&i.classList.add(HPH.config.classes.active)}if(e.target.matches(".hph-modal-close")){const t=e.target.closest(".hph-modal");t&&t.classList.remove(HPH.config.classes.active)}if(e.target.matches(".hph-accordion-toggle")){e.preventDefault();const t=e.target.nextElementSibling;t&&t.classList.contains("hph-accordion-content")&&(t.classList.toggle(HPH.config.classes.active),e.target.setAttribute("aria-expanded",t.classList.contains(HPH.config.classes.active)))}})},initDynamicContent:function(e){e.querySelectorAll(this.config.selectors.forms).forEach(i=>{i.addEventListener("submit",function(n){HPH.forms.submitForm(this)||n.preventDefault()}),i.querySelectorAll("input, select, textarea").forEach(n=>{n.addEventListener("blur",function(){HPH.forms.validateField(this)})})}),this.navigation.initDropdowns(),this.initUniversalCarousels(e)},initUniversalCarousels:function(e=document){const t=e.querySelectorAll(".hph-carousel__container");if(t.length!==0){if(typeof HphUniversalCarousel=="undefined"){console.warn("Universal Carousel class not loaded, attempting to load..."),this.loadUniversalCarousel();return}t.forEach((i,s)=>{try{if(i.hphCarousel)return;const n=new HphUniversalCarousel(i);i.hphCarousel=n,this.config.debug&&console.log("Universal Carousel initialized:",i.id||"carousel-".concat(s))}catch(n){console.error("Error initializing carousel:",n)}})}},loadUniversalCarousel:function(){if(this._carouselLoading)return;this._carouselLoading=!0;const e=document.createElement("script");e.src="/wp-content/themes/happy-place-theme/assets/js/components/universal-carousel.js",e.onload=()=>{this._carouselLoading=!1,this.initUniversalCarousels()},e.onerror=()=>{this._carouselLoading=!1,console.error("Failed to load Universal Carousel script")},document.head.appendChild(e)}},o(document).ready(function(){const e={nonce:window.hphNonce||"",debug:window.hphDebug||!1};HPH.init(e)}),typeof h!="undefined"&&h.exports&&(h.exports=HPH)})(jQuery);(function(o){typeof window.HPH=="undefined"&&(window.HPH={}),HPH.Forms={config:{ajaxUrl:window.ajaxurl||"/wp-admin/admin-ajax.php",nonce:"",debug:!1,selectors:{forms:"[data-route-type], .hph-form, .hph-general-contact-form, .hph-property-inquiry-form, .hph-agent-contact-form",validateForms:'form[data-validate="true"]',requiredFields:"input[required], select[required], textarea[required]",emailFields:'input[type="email"]',phoneFields:'input[type="tel"]',urlFields:'input[type="url"]',numberFields:'input[type="number"]'},classes:{error:"is-invalid",success:"is-valid",loading:"is-loading",disabled:"is-disabled"}},rules:{required:{test:function(e){return e&&e.trim().length>0},message:"This field is required"},email:{test:function(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)},message:"Please enter a valid email address"},phone:{test:function(e){const t=e.replace(/[\s\-\(\)\.]/g,"");return/^[\+]?[1-9][\d]{0,15}$/.test(t)},message:"Please enter a valid phone number"},url:{test:function(e){try{return new URL(e),!0}catch(t){return/^https?:\/\/.+/.test(e)}},message:"Please enter a valid URL"},number:{test:function(e){return!isNaN(e)&&e!==""},message:"Please enter a valid number"},minLength:{test:function(e,t){return e.length>=t},message:function(e){return"Please enter at least ".concat(e," characters")}},maxLength:{test:function(e,t){return e.length<=t},message:function(e){return"Please enter no more than ".concat(e," characters")}},price:{test:function(e){return/^\$?[\d,]+(\.\d{2})?$/.test(e.replace(/\s/g,""))},message:"Please enter a valid price (e.g., $250,000 or 250000)"}},init:function(){this.setupNonce(),this.bindEvents(),this.setupFormEnhancements(),this.initializeExistingForms()},setupNonce:function(){var e;this.config.nonce=o('meta[name="hph-nonce"]').attr("content")||o('input[name="hph_nonce"]').val()||o('input[name="_wpnonce"]').val()||"",this.config.ajaxUrl=((e=window.hph_ajax)==null?void 0:e.url)||window.ajaxurl||"/wp-admin/admin-ajax.php"},bindEvents:function(){console.log("HPH Forms: Binding events for selectors:",this.config.selectors.forms);const e=t=>{const i=t.target;if(i.tagName==="FORM"&&(i.action.includes("admin-ajax.php")||i.querySelector('input[name="action"][value="hph_route_form"]')||i.classList.contains("hph-form")||i.closest(".hph-modal")))return console.log("🚨 PREVENTING FORM SUBMISSION:",i),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),this.handleFormSubmission(t),!1};this._nativeSubmitListener&&document.removeEventListener("submit",this._nativeSubmitListener,!0),this._nativeSubmitListener=e.bind(this),document.addEventListener("submit",this._nativeSubmitListener,!0),o(document).off("submit.hph-forms").on("submit.hph-forms",this.config.selectors.forms,this.handleFormSubmission.bind(this)),o(document).off("submit.hph-modal-forms").on("submit.hph-modal-forms",".hph-modal form",this.handleFormSubmission.bind(this)),o(document).off("blur.hph-forms").on("blur.hph-forms",this.config.selectors.requiredFields,this.validateField.bind(this)),o(document).off("input.hph-forms").on("input.hph-forms",this.config.selectors.emailFields,this.debounce(this.validateField.bind(this),300)),o(document).off("input.hph-forms").on("input.hph-forms",this.config.selectors.phoneFields,this.debounce(this.validateField.bind(this),300)),o(document).off("input.hph-forms").on("input.hph-forms",this.config.selectors.urlFields,this.debounce(this.validateField.bind(this),300)),o(document).off("input.hph-forms").on("input.hph-forms",this.config.selectors.numberFields,this.debounce(this.validateField.bind(this),300)),o(document).off("submit.hph-validate").on("submit.hph-validate",this.config.selectors.validateForms,this.validateForm.bind(this)),o(document).off("focus.hph-forms").on("focus.hph-forms","input, select, textarea",this.clearFieldValidation.bind(this)),o(document).off("hph:forms:validate").on("hph:forms:validate",this.validateForm.bind(this)),o(document).off("hph:forms:reset").on("hph:forms:reset",this.resetForm.bind(this)),o(document).off("submit.hph-ajax-forms").on("submit.hph-ajax-forms",'form[action*="admin-ajax.php"]',this.handleFormSubmission.bind(this))},handleFormSubmission:function(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation();const t=o(e.currentTarget||e.target);if(t.data("hph-submitting"))return console.log("HPH Forms: Preventing duplicate submission"),!1;console.log("HPH Forms: Processing form submission",{form:t[0],action:t.attr("action"),method:t.attr("method"),routeType:t.data("route-type")});const i=t.attr("action");t.removeAttr("action");const s=this.getFormData(t);if(this.config.debug&&console.log("Form submission debug:",{form:t[0],data:s,routeType:t.data("route-type")}),!this.validateForm.call(this,e))return i&&t.attr("action",i),!1;t.data("hph-submitting",!0);const n=t.data("route-type")||"contact",a=this.getSubmissionMethod(t,n);return this.submitForm(t,s,a,i),!1},getFormData:function(e){const t=new FormData(e[0]);return t.append("nonce",this.config.nonce),!t.has("route_type")&&e.data("route-type")&&t.append("route_type",e.data("route-type")),t},getSubmissionMethod:function(e,t){const i=e.find('input[name="action"]').val();return i||{contact:"hph_route_form","property-inquiry":"hph_route_form","agent-contact":"hph_route_form","valuation-request":"hph_route_form","showing-request":"hph_route_form","general-inquiry":"hph_route_form","listing-form":"hph_route_form","lead-form":"hph_route_form",lead_capture:"hph_route_form"}[t]||"hph_route_form"},submitForm:function(e,t,i,s){const n=this;t.append("action",i),console.log("HPH Forms: Submitting via AJAX",{url:this.config.ajaxUrl,action:i,formId:e.attr("id")||"unnamed"}),this.setFormLoading(e,!0),o.ajax({url:this.config.ajaxUrl,type:"POST",data:t,processData:!1,contentType:!1,success:function(a){console.log("HPH Forms: AJAX success",a),n.handleFormSuccess(e,a)},error:function(a,r,c){console.error("HPH Forms: AJAX error",{xhr:a,status:r,error:c}),n.handleFormError(e,"Submission failed: ".concat(c))},complete:function(){e.removeData("hph-submitting"),n.setFormLoading(e,!1),s&&e.attr("action",s)}})},handleFormSuccess:function(e,t){var i;if(e.removeData("hph-submitting"),t.success){const s=e.closest(".hph-modal");s.length?this.handleModalFormSuccess(e,s,t):(this.showFormMessage(e,t.data.message||"Form submitted successfully!","success"),this.resetForm({target:e[0]})),e.trigger("hph:forms:success",[t]),t.data.redirect&&setTimeout(()=>{window.location.href=t.data.redirect},1500)}else this.handleFormError(e,((i=t.data)==null?void 0:i.message)||"Form submission failed")},handleModalFormSuccess:function(e,t,i){var a;const s=t.find(".hph-modal-form-container"),n=t.find(".hph-modal-success");s.length&&n.length?(s.fadeOut(300,function(){var d;const c=((d=i.data)==null?void 0:d.message)||"Thank you! We'll contact you soon.",l=n.find("p");l.length&&l.text(c),n.fadeIn(300)}),t.data("close-on-success")!=="false"&&setTimeout(()=>{window.closeHphFormModal&&window.closeHphFormModal(t.attr("id"))},3e3)):this.showFormMessage(e,((a=i.data)==null?void 0:a.message)||"Thank you! We'll contact you soon.","success"),this.resetForm({target:e[0]})},handleFormError:function(e,t){e.removeData("hph-submitting"),this.showFormMessage(e,t,"error"),e.trigger("hph:forms:error",[t])},showFormMessage:function(e,t,i="info"){e.find(".hph-form-message").remove();const s=o('\n                <div class="hph-form-message hph-form-message-'.concat(i,'">\n                    <span class="hph-form-message-text">').concat(t,'</span>\n                    <button type="button" class="hph-form-message-close">&times;</button>\n                </div>\n            '));e.prepend(s),i==="success"&&setTimeout(()=>{s.fadeOut(()=>s.remove())},5e3),s.find(".hph-form-message-close").on("click",function(){s.fadeOut(()=>s.remove())})},validateForm:function(e){const t=o(e.target||e.currentTarget);let i=!0;return t.is(this.config.selectors.validateForms)?(t.find(this.config.selectors.requiredFields).each((s,n)=>{this.validateField({target:n})||(i=!1)}),t.find(this.config.selectors.emailFields).each((s,n)=>{o(n).val()&&!this.validateField({target:n})&&(i=!1)}),t.find(this.config.selectors.phoneFields).each((s,n)=>{o(n).val()&&!this.validateField({target:n})&&(i=!1)}),!i&&e.preventDefault&&e.preventDefault(),i):!0},validateField:function(e){const t=o(e.target||e.currentTarget),i=t.val(),s=t.attr("type"),n=t.prop("required");let a=!0,r="";if(n&&!this.rules.required.test(i)&&(a=!1,r=this.rules.required.message),i&&a)switch(s){case"email":this.rules.email.test(i)||(a=!1,r=this.rules.email.message);break;case"tel":this.rules.phone.test(i)||(a=!1,r=this.rules.phone.message);break;case"url":this.rules.url.test(i)||(a=!1,r=this.rules.url.message);break;case"number":this.rules.number.test(i)||(a=!1,r=this.rules.number.message);break}if(i&&a){const c=t.data("min-length"),l=t.data("max-length");c&&!this.rules.minLength.test(i,c)&&(a=!1,r=this.rules.minLength.message(c)),l&&!this.rules.maxLength.test(i,l)&&(a=!1,r=this.rules.maxLength.message(l)),t.hasClass("price-field")&&!this.rules.price.test(i)&&(a=!1,r=this.rules.price.message)}return this.setFieldValidationState(t,a,r),a},setFieldValidationState:function(e,t,i=""){const s=e.closest(".form-group, .hph-form-group");if(e.removeClass("".concat(this.config.classes.error," ").concat(this.config.classes.success)),s.find(".invalid-feedback, .hph-field-error").remove(),t)e.addClass(this.config.classes.success);else if(e.addClass(this.config.classes.error),i){const n=o('<div class="invalid-feedback hph-field-error"></div>').text(i);s.length?s.append(n):e.after(n)}},clearFieldValidation:function(e){const t=o(e.target),i=t.closest(".form-group, .hph-form-group");t.removeClass("".concat(this.config.classes.error," ").concat(this.config.classes.success)),i.find(".invalid-feedback, .hph-field-error").remove()},setupFormEnhancements:function(){this.setupLoadingStates(),this.setupPlaceholderEnhancements(),this.setupFieldFormatting()},setupLoadingStates:function(){o(this.config.selectors.forms).each(function(){const t=o(this).find('button[type="submit"], input[type="submit"]');t.find(".loading-spinner").length||t.append('<span class="loading-spinner" style="display:none;">⏳</span>')})},setupPlaceholderEnhancements:function(){o("input[placeholder], textarea[placeholder]").on("focus",function(){o(this).data("original-placeholder",o(this).attr("placeholder"))}).on("blur",function(){const e=o(this).data("original-placeholder");e&&o(this).attr("placeholder",e)})},setupFieldFormatting:function(){o(this.config.selectors.phoneFields).on("input",function(){let e=o(this).val().replace(/\D/g,"");e.length>0&&(e.length<=3?e="(".concat(e):e.length<=6?e="(".concat(e.slice(0,3),") ").concat(e.slice(3)):e="(".concat(e.slice(0,3),") ").concat(e.slice(3,6),"-").concat(e.slice(6,10)),o(this).val(e))})},setFormLoading:function(e,t){const i=e.find('button[type="submit"], input[type="submit"]'),s=i.find(".loading-spinner");if(t)e.addClass(this.config.classes.loading),i.prop("disabled",!0).addClass(this.config.classes.disabled),s.show(),i.data("original-text")||i.data("original-text",i.text()),i.text("Submitting...");else{e.removeClass(this.config.classes.loading),i.prop("disabled",!1).removeClass(this.config.classes.disabled),s.hide();const n=i.data("original-text");n&&i.text(n)}},resetForm:function(e){const t=o(e.target||e.currentTarget);t[0].reset(),t.find("input, select, textarea").removeClass("".concat(this.config.classes.error," ").concat(this.config.classes.success)),t.find(".invalid-feedback, .hph-field-error").remove(),t.find(".hph-form-message").remove(),t.trigger("hph:forms:reset")},initializeExistingForms:function(){o(this.config.selectors.forms).each((e,t)=>{const i=o(t);i.attr("novalidate")||i.attr("novalidate","novalidate"),i.hasClass("needs-validation")||i.addClass("needs-validation")})},debounce:function(e,t){let i;return function(...n){const a=()=>{clearTimeout(i),e(...n)};clearTimeout(i),i=setTimeout(a,t)}},validate:function(e){const t=o(e);return this.validateForm({target:t[0]})},submit:function(e){o(e).trigger("submit")},addRule:function(e,t,i){this.rules[e]={test:t,message:i}}},o(document).ready(function(){HPH.Forms.init()}),window.FormValidation=HPH.Forms,window.HappyPlaceFormHandler=HPH.Forms,typeof h!="undefined"&&h.exports&&(h.exports=HPH.Forms)})(jQuery)});export default H();
