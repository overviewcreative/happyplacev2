!function(){"use strict";class e{constructor(){this.init()}init(){this.setupEventListeners(),this.initializeComponents()}setupEventListeners(){document.addEventListener("click",e=>{e.target.matches(".btn-save-settings")&&(e.preventDefault(),this.saveSettings(e.target.closest("form"))),e.target.matches(".btn-import-data")&&(e.preventDefault(),this.importData(e.target.dataset.type)),e.target.matches(".btn-export-data")&&(e.preventDefault(),this.exportData(e.target.dataset.type))}),document.addEventListener("submit",e=>{e.target.matches(".admin-form")&&(this.validateForm(e.target)||e.preventDefault())})}initializeComponents(){this.initTabs(),this.initColorPickers(),this.initFileUploads(),this.initTooltips()}async saveSettings(e){if(e)try{this.showLoading();const t=new FormData(e);t.append("action","hp_save_settings"),t.append("nonce",window.hp_admin?.nonce||"");const i=await fetch(window.hp_admin?.ajax_url||"/wp-admin/admin-ajax.php",{method:"POST",body:t}),o=await i.json();if(!o.success)throw new Error(o.data?.message||"Failed to save settings");this.showNotification("Settings saved successfully","success")}catch(e){this.showNotification("Error saving settings","error")}finally{this.hideLoading()}}async importData(e){const t=document.querySelector(`#import-${e}-file`);if(t&&t.files[0])try{this.showLoading();const i=new FormData;i.append("action","hp_import_data"),i.append("type",e),i.append("file",t.files[0]),i.append("nonce",window.hp_admin?.nonce||"");const o=await fetch(window.hp_admin?.ajax_url||"/wp-admin/admin-ajax.php",{method:"POST",body:i}),n=await o.json();if(!n.success)throw new Error(n.data?.message||"Import failed");this.showNotification(`${e} data imported successfully`,"success"),t.value=""}catch(e){this.showNotification("Error importing data","error")}finally{this.hideLoading()}else this.showNotification("Please select a file to import","error")}async exportData(e){try{this.showLoading();const t=new URLSearchParams({action:"hp_export_data",type:e,nonce:window.hp_admin?.nonce||""}),i=`${window.hp_admin?.ajax_url||"/wp-admin/admin-ajax.php"}?${t}`,o=document.createElement("a");o.href=i,o.download=`${e}-export.csv`,o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),this.showNotification(`${e} data exported successfully`,"success")}catch(e){this.showNotification("Error exporting data","error")}finally{this.hideLoading()}}validateForm(e){const t=e.querySelectorAll("[required]");let i=!0;t.forEach(e=>{e.value.trim()?this.clearFieldError(e):(this.showFieldError(e,"This field is required"),i=!1)});return e.querySelectorAll('input[type="email"]').forEach(e=>{e.value&&!this.isValidEmail(e.value)&&(this.showFieldError(e,"Please enter a valid email address"),i=!1)}),i}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}showFieldError(e,t){this.clearFieldError(e);const i=document.createElement("div");i.className="field-error",i.textContent=t,e.classList.add("is-invalid"),e.parentNode.appendChild(i)}clearFieldError(e){e.classList.remove("is-invalid");const t=e.parentNode.querySelector(".field-error");t&&t.remove()}initTabs(){const e=document.querySelectorAll(".nav-tab"),t=document.querySelectorAll(".tab-content");e.forEach(i=>{i.addEventListener("click",o=>{o.preventDefault();const n=i.getAttribute("href").substring(1);e.forEach(e=>e.classList.remove("nav-tab-active")),i.classList.add("nav-tab-active"),t.forEach(e=>{e.style.display=e.id===n?"block":"none"})})})}initColorPickers(){document.querySelectorAll('input[type="color"]').forEach(e=>{e.addEventListener("change",e=>{})})}initFileUploads(){document.querySelectorAll('.file-upload input[type="file"]').forEach(e=>{e.addEventListener("change",t=>{const i=t.target.files,o=e.nextElementSibling;i.length>0?o.textContent=i[0].name:o.textContent="Choose file"})})}initTooltips(){document.querySelectorAll("[data-tooltip]").forEach(e=>{e.addEventListener("mouseenter",e=>{this.showTooltip(e.target,e.target.dataset.tooltip)}),e.addEventListener("mouseleave",e=>{this.hideTooltip()})})}showTooltip(e,t){const i=document.createElement("div");i.className="admin-tooltip",i.textContent=t,document.body.appendChild(i);const o=e.getBoundingClientRect();i.style.position="absolute",i.style.left=o.left+"px",i.style.top=o.bottom+5+"px"}hideTooltip(){const e=document.querySelector(".admin-tooltip");e&&e.remove()}showLoading(){const e=document.querySelector(".admin-loader");e&&(e.style.display="block")}hideLoading(){const e=document.querySelector(".admin-loader");e&&(e.style.display="none")}showNotification(e,t="info"){const i=document.createElement("div");i.className=`notice notice-${t} is-dismissible`,i.innerHTML=`\n            <p>${e}</p>\n            <button type="button" class="notice-dismiss">\n                <span class="screen-reader-text">Dismiss this notice.</span>\n            </button>\n        `;const o=document.querySelector(".wrap h1");o?o.parentNode.insertBefore(i,o.nextSibling):document.body.appendChild(i),setTimeout(()=>{i.remove()},5e3),i.querySelector(".notice-dismiss").addEventListener("click",()=>{i.remove()})}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{new e}):new e}();